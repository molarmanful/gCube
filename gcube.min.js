function ntscramble(e){var t="";e.trim().split(/\s+/).forEach(function(e){if(e.length===2){if(e[1]==="2"){t+=e[0]+e[0]}else{t+=e[0].toLowerCase()}}else{t+=e[0]}});return t}function ntsolve(e){var t="";e.trim().split(/\s+/).reverse().forEach(function(e){if(e.length===2){if(e[1]==="2"){t+=e[0]+e[0]}else{t+=e[0]}}else{t+=e[0].toLowerCase()}});return t}(function(){var e={};(function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail);return n}e.prototype=window.Event.prototype;window.CustomEvent=e;Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};r.prototype=this.prototype;i.prototype=new r;return i})})();e.extend=function(e,t){if(Object.keys)for(var n=Object.keys(t),r=0,i=n.length;r<i;r++){var s=n[r];Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))}else for(s in n={}.hasOwnProperty,t)n.call(t,s)&&(e[s]=t[s]);return e};void 0===Date.now&&(Date.now=function(){return(new Date).valueOf()});var t=t||function(){var e=[];return{REVISION:"12",getAll:function(){return e},removeAll:function(){e=[]},add:function(t){e.push(t)},remove:function(t){t=e.indexOf(t);-1!==t&&e.splice(t,1)},update:function(t){if(0===e.length)return!1;var n=0;for(t=void 0!==t?t:"undefined"!==typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();n<e.length;)e[n].update(t)?n++:e.splice(n,1);return!0}}}();t.Tween=function(e){var n={},r={},i={},s=1e3,o=0,u=!1,a=!1,f=0,l=null,c=t.Easing.Linear.None,h=t.Interpolation.Linear,p=[],d=null,v=!1,m=null,g=null,y;for(y in e)n[y]=parseFloat(e[y],10);this.to=function(e,t){void 0!==t&&(s=t);r=e;return this};this.start=function(s){t.add(this);a=!0;v=!1;l=void 0!==s?s:"undefined"!==typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();l+=f;for(var o in r){if(r[o]instanceof Array){if(0===r[o].length)continue;r[o]=[e[o]].concat(r[o])}n[o]=e[o];!1===n[o]instanceof Array&&(n[o]*=1);i[o]=n[o]||0}return this};this.stop=function(){if(!a)return this;t.remove(this);a=!1;this.stopChainedTweens();return this};this.stopChainedTweens=function(){for(var e=0,t=p.length;e<t;e++)p[e].stop()};this.delay=function(e){f=e;return this};this.repeat=function(e){o=e;return this};this.yoyo=function(e){u=e;return this};this.easing=function(e){c=e;return this};this.interpolation=function(e){h=e;return this};this.chain=function(){p=arguments;return this};this.onStart=function(e){d=e;return this};this.onUpdate=function(e){m=e;return this};this.onComplete=function(e){g=e;return this};this.update=function(t){var a;if(t<l)return!0;!1===v&&(null!==d&&d.call(e),v=!0);var y=(t-l)/s,y=1<y?1:y,w=c(y);for(a in r){var E=n[a]||0,S=r[a];S instanceof Array?e[a]=h(S,w):("string"===typeof S&&(S=E+parseFloat(S,10)),"number"===typeof S&&(e[a]=E+(S-E)*w))}null!==m&&m.call(e,w);if(1==y)if(0<o){isFinite(o)&&o--;for(a in i)"string"===typeof r[a]&&(i[a]+=parseFloat(r[a],10)),u&&(y=i[a],i[a]=r[a],r[a]=y),n[a]=i[a];l=t+f}else{null!==g&&g.call(e);a=0;for(y=p.length;a<y;a++)p[a].start(t);return!1}return!0}};t.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return 1>(e*=2)?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return 1>(e*=2)?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return 1>(e*=2)?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return 1>(e*=2)?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:1>(e*=2)?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return 1>(e*=2)?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t,n=.1;if(0===e)return 0;if(1===e)return 1;!n||1>n?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI);return-(n*Math.pow(2,10*(e-=1))*Math.sin(2*(e-t)*Math.PI/.4))},Out:function(e){var t,n=.1;if(0===e)return 0;if(1===e)return 1;!n||1>n?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI);return n*Math.pow(2,-10*e)*Math.sin(2*(e-t)*Math.PI/.4)+1},InOut:function(e){var t,n=.1;if(0===e)return 0;if(1===e)return 1;!n||1>n?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI);return 1>(e*=2)?-.5*n*Math.pow(2,10*(e-=1))*Math.sin(2*(e-t)*Math.PI/.4):n*Math.pow(2,-10*(e-=1))*Math.sin(2*(e-t)*Math.PI/.4)*.5+1}},Back:{In:function(e){return e*e*(2.70158*e-1.70158)},Out:function(e){return--e*e*(2.70158*e+1.70158)+1},InOut:function(e){return 1>(e*=2)?.5*e*e*(3.5949095*e-2.5949095):.5*((e-=2)*e*(3.5949095*e+2.5949095)+2)}},Bounce:{In:function(e){return 1-t.Easing.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return.5>e?.5*t.Easing.Bounce.In(2*e):.5*t.Easing.Bounce.Out(2*e-1)+.5}}};t.Interpolation={Linear:function(e,n){var r=e.length-1,i=r*n,s=Math.floor(i),o=t.Interpolation.Utils.Linear;return 0>n?o(e[0],e[1],i):1<n?o(e[r],e[r-1],r-i):o(e[s],e[s+1>r?r:s+1],i-s)},Bezier:function(e,n){var r=0,i=e.length-1,s=Math.pow,o=t.Interpolation.Utils.Bernstein,u;for(u=0;u<=i;u++)r+=s(1-n,i-u)*s(n,u)*e[u]*o(i,u);return r},CatmullRom:function(e,n){var r=e.length-1,i=r*n,s=Math.floor(i),o=t.Interpolation.Utils.CatmullRom;return e[0]===e[r]?(0>n&&(s=Math.floor(i=r*(1+n))),o(e[(s-1+r)%r],e[s],e[(s+1)%r],e[(s+2)%r],i-s)):0>n?e[0]-(o(e[0],e[0],e[1],e[1],-i)-e[0]):1<n?e[r]-(o(e[r],e[r],e[r-1],e[r-1],i-r)-e[r]):o(e[s?s-1:0],e[s],e[r<s+1?r:s+1],e[r<s+2?r:s+2],i-s)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,n){var r=t.Interpolation.Utils.Factorial;return r(e)/r(n)/r(e-n)},Factorial:function(){var e=[1];return function(t){var n=1,r;if(e[t])return e[t];for(r=t;1<r;r--)n*=r;return e[t]=n}}(),CatmullRom:function(e,t,n,r,i){e=.5*(n-e);r=.5*(r-t);var s=i*i;return(2*t-2*n+e+r)*i*s+(-3*t+3*n-2*e-r)*s+e*i+t}}};var n={REVISION:"66"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}};(function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!self.requestAnimationFrame;++n)self.requestAnimationFrame=self[t[n]+"RequestAnimationFrame"],self.cancelAnimationFrame=self[t[n]+"CancelAnimationFrame"]||self[t[n]+"CancelRequestAnimationFrame"];void 0===self.requestAnimationFrame&&void 0!==self.setTimeout&&(self.requestAnimationFrame=function(t){var n=Date.now(),r=Math.max(0,16-(n-e)),i=self.setTimeout(function(){t(n+r)},r);e=n+r;return i});void 0===self.cancelAnimationFrame&&void 0!==self.clearTimeout&&(self.cancelAnimationFrame=function(e){self.clearTimeout(e)})})();n.CullFaceNone=0;n.CullFaceBack=1;n.CullFaceFront=2;n.CullFaceFrontBack=3;n.FrontFaceDirectionCW=0;n.FrontFaceDirectionCCW=1;n.BasicShadowMap=0;n.PCFShadowMap=1;n.PCFSoftShadowMap=2;n.FrontSide=0;n.BackSide=1;n.DoubleSide=2;n.NoShading=0;n.FlatShading=1;n.SmoothShading=2;n.NoColors=0;n.FaceColors=1;n.VertexColors=2;n.NoBlending=0;n.NormalBlending=1;n.AdditiveBlending=2;n.SubtractiveBlending=3;n.MultiplyBlending=4;n.CustomBlending=5;n.AddEquation=100;n.SubtractEquation=101;n.ReverseSubtractEquation=102;n.ZeroFactor=200;n.OneFactor=201;n.SrcColorFactor=202;n.OneMinusSrcColorFactor=203;n.SrcAlphaFactor=204;n.OneMinusSrcAlphaFactor=205;n.DstAlphaFactor=206;n.OneMinusDstAlphaFactor=207;n.DstColorFactor=208;n.OneMinusDstColorFactor=209;n.SrcAlphaSaturateFactor=210;n.MultiplyOperation=0;n.MixOperation=1;n.AddOperation=2;n.UVMapping=function(){};n.CubeReflectionMapping=function(){};n.CubeRefractionMapping=function(){};n.SphericalReflectionMapping=function(){};n.SphericalRefractionMapping=function(){};n.RepeatWrapping=1e3;n.ClampToEdgeWrapping=1001;n.MirroredRepeatWrapping=1002;n.NearestFilter=1003;n.NearestMipMapNearestFilter=1004;n.NearestMipMapLinearFilter=1005;n.LinearFilter=1006;n.LinearMipMapNearestFilter=1007;n.LinearMipMapLinearFilter=1008;n.UnsignedByteType=1009;n.ByteType=1010;n.ShortType=1011;n.UnsignedShortType=1012;n.IntType=1013;n.UnsignedIntType=1014;n.FloatType=1015;n.UnsignedShort4444Type=1016;n.UnsignedShort5551Type=1017;n.UnsignedShort565Type=1018;n.AlphaFormat=1019;n.RGBFormat=1020;n.RGBAFormat=1021;n.LuminanceFormat=1022;n.LuminanceAlphaFormat=1023;n.RGB_S3TC_DXT1_Format=2001;n.RGBA_S3TC_DXT1_Format=2002;n.RGBA_S3TC_DXT3_Format=2003;n.RGBA_S3TC_DXT5_Format=2004;n.EventDispatcher=function(){};n.EventDispatcher.prototype={constructor:n.EventDispatcher,apply:function(e){e.addEventListener=n.EventDispatcher.prototype.addEventListener;e.hasEventListener=n.EventDispatcher.prototype.hasEventListener;e.removeEventListener=n.EventDispatcher.prototype.removeEventListener;e.dispatchEvent=n.EventDispatcher.prototype.dispatchEvent},addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]);-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)?!0:!1},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(){var e=[];return function(t){if(void 0!==this._listeners){var n=this._listeners[t.type];if(void 0!==n){t.target=this;for(var r=n.length,i=0;i<r;i++)e[i]=n[i];for(i=0;i<r;i++)e[i].call(this,t)}}}}()};n.Math={PI2:2*Math.PI,generateUUID:function(){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),t=Array(36),n=0,r;return function(){for(var i=0;36>i;i++)8==i||13==i||18==i||23==i?t[i]="-":14==i?t[i]="4":(2>=n&&(n=33554432+16777216*Math.random()|0),r=n&15,n>>=4,t[i]=e[19==i?r&3|8:r]);return t.join("")}}(),clamp:function(e,t,n){return e<t?t:e>n?n:e},clampBottom:function(e,t){return e<t?t:e},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},smoothstep:function(e,t,n){if(e<=t)return 0;if(e>=n)return 1;e=(e-t)/(n-t);return e*e*(3-2*e)},smootherstep:function(e,t,n){if(e<=t)return 0;if(e>=n)return 1;e=(e-t)/(n-t);return e*e*e*(e*(6*e-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},sign:function(e){return 0>e?-1:0<e?1:0},degToRad:function(){var e=Math.PI/180;return function(t){return t*e}}(),radToDeg:function(){var e=180/Math.PI;return function(t){return t*e}}(),isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e}};n.Quaternion=function(e,t,n,r){this._x=e||0;this._y=t||0;this._z=n||0;this._w=void 0!==r?r:1};n.Quaternion.prototype={constructor:n.Quaternion,_x:0,_y:0,_z:0,_w:0,_euler:void 0,_updateEuler:function(e){void 0!==this._euler&&this._euler.setFromQuaternion(this,void 0,!1)},get x(){return this._x},set x(e){this._x=e;this._updateEuler()},get y(){return this._y},set y(e){this._y=e;this._updateEuler()},get z(){return this._z},set z(e){this._z=e;this._updateEuler()},get w(){return this._w},set w(e){this._w=e;this._updateEuler()},set:function(e,t,n,r){this._x=e;this._y=t;this._z=n;this._w=r;this._updateEuler();return this},copy:function(e){this._x=e._x;this._y=e._y;this._z=e._z;this._w=e._w;this._updateEuler();return this},setFromEuler:function(e,t){if(!1===e instanceof n.Euler)throw Error("ERROR: Quaternion's .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var r=Math.cos(e._x/2),i=Math.cos(e._y/2),s=Math.cos(e._z/2),o=Math.sin(e._x/2),u=Math.sin(e._y/2),a=Math.sin(e._z/2);"XYZ"===e.order?(this._x=o*i*s+r*u*a,this._y=r*u*s-o*i*a,this._z=r*i*a+o*u*s,this._w=r*i*s-o*u*a):"YXZ"===e.order?(this._x=o*i*s+r*u*a,this._y=r*u*s-o*i*a,this._z=r*i*a-o*u*s,this._w=r*i*s+o*u*a):"ZXY"===e.order?(this._x=o*i*s-r*u*a,this._y=r*u*s+o*i*a,this._z=r*i*a+o*u*s,this._w=r*i*s-o*u*a):"ZYX"===e.order?(this._x=o*i*s-r*u*a,this._y=r*u*s+o*i*a,this._z=r*i*a-o*u*s,this._w=r*i*s+o*u*a):"YZX"===e.order?(this._x=o*i*s+r*u*a,this._y=r*u*s+o*i*a,this._z=r*i*a-o*u*s,this._w=r*i*s-o*u*a):"XZY"===e.order&&(this._x=o*i*s-r*u*a,this._y=r*u*s-o*i*a,this._z=r*i*a+o*u*s,this._w=r*i*s+o*u*a);!1!==t&&this._updateEuler();return this},setFromAxisAngle:function(e,t){var n=t/2,r=Math.sin(n);this._x=e.x*r;this._y=e.y*r;this._z=e.z*r;this._w=Math.cos(n);this._updateEuler();return this},setFromRotationMatrix:function(e){var t=e.elements,n=t[0];e=t[4];var r=t[8],i=t[1],s=t[5],o=t[9],u=t[2],a=t[6],t=t[10],f=n+s+t;0<f?(n=.5/Math.sqrt(f+1),this._w=.25/n,this._x=(a-o)*n,this._y=(r-u)*n,this._z=(i-e)*n):n>s&&n>t?(n=2*Math.sqrt(1+n-s-t),this._w=(a-o)/n,this._x=.25*n,this._y=(e+i)/n,this._z=(r+u)/n):s>t?(n=2*Math.sqrt(1+s-n-t),this._w=(r-u)/n,this._x=(e+i)/n,this._y=.25*n,this._z=(o+a)/n):(n=2*Math.sqrt(1+t-n-s),this._w=(i-e)/n,this._x=(r+u)/n,this._y=(o+a)/n,this._z=.25*n);this._updateEuler();return this},inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this._updateEuler();return this},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();0===e?(this._z=this._y=this._x=0,this._w=1):(e=1/e,this._x*=e,this._y*=e,this._z*=e,this._w*=e);return this},multiply:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var n=e._x,r=e._y,i=e._z,s=e._w,o=t._x,u=t._y,a=t._z,f=t._w;this._x=n*f+s*o+r*a-i*u;this._y=r*f+s*u+i*o-n*a;this._z=i*f+s*a+n*u-r*o;this._w=s*f-n*o-r*u-i*a;this._updateEuler();return this},multiplyVector3:function(e){console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return e.applyQuaternion(this)},slerp:function(e,t){var n=this._x,r=this._y,i=this._z,s=this._w,o=s*e._w+n*e._x+r*e._y+i*e._z;0>o?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e);if(1<=o)return this._w=s,this._x=n,this._y=r,this._z=i,this;var u=Math.acos(o),a=Math.sqrt(1-o*o);if(.001>Math.abs(a))return this._w=.5*(s+this._w),this._x=.5*(n+this._x),this._y=.5*(r+this._y),this._z=.5*(i+this._z),this;o=Math.sin((1-t)*u)/a;u=Math.sin(t*u)/a;this._w=s*o+this._w*u;this._x=n*o+this._x*u;this._y=r*o+this._y*u;this._z=i*o+this._z*u;this._updateEuler();return this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e){this._x=e[0];this._y=e[1];this._z=e[2];this._w=e[3];this._updateEuler();return this},toArray:function(){return[this._x,this._y,this._z,this._w]},clone:function(){return new n.Quaternion(this._x,this._y,this._z,this._w)}};n.Quaternion.slerp=function(e,t,n,r){return n.copy(e).slerp(t,r)};n.Vector2=function(e,t){this.x=e||0;this.y=t||0};n.Vector2.prototype={constructor:n.Vector2,set:function(e,t){this.x=e;this.y=t;return this},setX:function(e){this.x=e;return this},setY:function(e){this.y=e;return this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+e)}},copy:function(e){this.x=e.x;this.y=e.y;return this},add:function(e,t){if(void 0!==t)return console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t);this.x+=e.x;this.y+=e.y;return this},addVectors:function(e,t){this.x=e.x+t.x;this.y=e.y+t.y;return this},addScalar:function(e){this.x+=e;this.y+=e;return this},sub:function(e,t){if(void 0!==t)return console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t);this.x-=e.x;this.y-=e.y;return this},subVectors:function(e,t){this.x=e.x-t.x;this.y=e.y-t.y;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;return this},divideScalar:function(e){0!==e?(e=1/e,this.x*=e,this.y*=e):this.y=this.x=0;return this},min:function(e){this.x>e.x&&(this.x=e.x);this.y>e.y&&(this.y=e.y);return this},max:function(e){this.x<e.x&&(this.x=e.x);this.y<e.y&&(this.y=e.y);return this},clamp:function(e,t){this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x);this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y);return this},clampScalar:function(){var e,t;return function(r,i){void 0===e&&(e=new n.Vector2,t=new n.Vector2);e.set(r,r);t.set(i,i);return this.clamp(e,t)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x;e=this.y-e.y;return t*t+e*e},setLength:function(e){var t=this.length();0!==t&&e!==t&&this.multiplyScalar(e/t);return this},lerp:function(e,t){this.x+=(e.x-this.x)*t;this.y+=(e.y-this.y)*t;return this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e){this.x=e[0];this.y=e[1];return this},toArray:function(){return[this.x,this.y]},clone:function(){return new n.Vector2(this.x,this.y)}};n.Vector3=function(e,t,n){this.x=e||0;this.y=t||0;this.z=n||0};n.Vector3.prototype={constructor:n.Vector3,set:function(e,t,n){this.x=e;this.y=t;this.z=n;return this},setX:function(e){this.x=e;return this},setY:function(e){this.y=e;return this},setZ:function(e){this.z=e;return this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+e)}},copy:function(e){this.x=e.x;this.y=e.y;this.z=e.z;return this},add:function(e,t){if(void 0!==t)return console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t);this.x+=e.x;this.y+=e.y;this.z+=e.z;return this},addScalar:function(e){this.x+=e;this.y+=e;this.z+=e;return this},addVectors:function(e,t){this.x=e.x+t.x;this.y=e.y+t.y;this.z=e.z+t.z;return this},sub:function(e,t){if(void 0!==t)return console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t);this.x-=e.x;this.y-=e.y;this.z-=e.z;return this},subVectors:function(e,t){this.x=e.x-t.x;this.y=e.y-t.y;this.z=e.z-t.z;return this},multiply:function(e,t){if(void 0!==t)return console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t);this.x*=e.x;this.y*=e.y;this.z*=e.z;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;this.z*=e;return this},multiplyVectors:function(e,t){this.x=e.x*t.x;this.y=e.y*t.y;this.z=e.z*t.z;return this},applyEuler:function(){var e;return function(t){!1===t instanceof n.Euler&&console.error("ERROR: Vector3's .applyEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");void 0===e&&(e=new n.Quaternion);this.applyQuaternion(e.setFromEuler(t));return this}}(),applyAxisAngle:function(){var e;return function(t,r){void 0===e&&(e=new n.Quaternion);this.applyQuaternion(e.setFromAxisAngle(t,r));return this}}(),applyMatrix3:function(e){var t=this.x,n=this.y,r=this.z;e=e.elements;this.x=e[0]*t+e[3]*n+e[6]*r;this.y=e[1]*t+e[4]*n+e[7]*r;this.z=e[2]*t+e[5]*n+e[8]*r;return this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z;e=e.elements;this.x=e[0]*t+e[4]*n+e[8]*r+e[12];this.y=e[1]*t+e[5]*n+e[9]*r+e[13];this.z=e[2]*t+e[6]*n+e[10]*r+e[14];return this},applyProjection:function(e){var t=this.x,n=this.y,r=this.z;e=e.elements;var i=1/(e[3]*t+e[7]*n+e[11]*r+e[15]);this.x=(e[0]*t+e[4]*n+e[8]*r+e[12])*i;this.y=(e[1]*t+e[5]*n+e[9]*r+e[13])*i;this.z=(e[2]*t+e[6]*n+e[10]*r+e[14])*i;return this},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,s=e.y,o=e.z;e=e.w;var u=e*t+s*r-o*n,a=e*n+o*t-i*r,f=e*r+i*n-s*t,t=-i*t-s*n-o*r;this.x=u*e+t*-i+a*-o-f*-s;this.y=a*e+t*-s+f*-i-u*-o;this.z=f*e+t*-o+u*-s-a*-i;return this},transformDirection:function(e){var t=this.x,n=this.y,r=this.z;e=e.elements;this.x=e[0]*t+e[4]*n+e[8]*r;this.y=e[1]*t+e[5]*n+e[9]*r;this.z=e[2]*t+e[6]*n+e[10]*r;this.normalize();return this},divide:function(e){this.x/=e.x;this.y/=e.y;this.z/=e.z;return this},divideScalar:function(e){0!==e?(e=1/e,this.x*=e,this.y*=e,this.z*=e):this.z=this.y=this.x=0;return this},min:function(e){this.x>e.x&&(this.x=e.x);this.y>e.y&&(this.y=e.y);this.z>e.z&&(this.z=e.z);return this},max:function(e){this.x<e.x&&(this.x=e.x);this.y<e.y&&(this.y=e.y);this.z<e.z&&(this.z=e.z);return this},clamp:function(e,t){this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x);this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y);this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z);return this},clampScalar:function(){var e,t;return function(r,i){void 0===e&&(e=new n.Vector3,t=new n.Vector3);e.set(r,r,r);t.set(i,i,i);return this.clamp(e,t)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();0!==t&&e!==t&&this.multiplyScalar(e/t);return this},lerp:function(e,t){this.x+=(e.x-this.x)*t;this.y+=(e.y-this.y)*t;this.z+=(e.z-this.z)*t;return this},cross:function(e,t){if(void 0!==t)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var n=this.x,r=this.y,i=this.z;this.x=r*e.z-i*e.y;this.y=i*e.x-n*e.z;this.z=n*e.y-r*e.x;return this},crossVectors:function(e,t){var n=e.x,r=e.y,i=e.z,s=t.x,o=t.y,u=t.z;this.x=r*u-i*o;this.y=i*s-n*u;this.z=n*o-r*s;return this},projectOnVector:function(){var e,t;return function(r){void 0===e&&(e=new n.Vector3);e.copy(r).normalize();t=this.dot(e);return this.copy(e).multiplyScalar(t)}}(),projectOnPlane:function(){var e;return function(t){void 0===e&&(e=new n.Vector3);e.copy(this).projectOnVector(t);return this.sub(e)}}(),reflect:function(){var e;return function(t){void 0===e&&(e=new n.Vector3);return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){e=this.dot(e)/(this.length()*e.length());return Math.acos(n.Math.clamp(e,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;e=this.z-e.z;return t*t+n*n+e*e},setEulerFromRotationMatrix:function(e,t){console.error("REMOVED: Vector3's setEulerFromRotationMatrix has been removed in favor of Euler.setFromRotationMatrix(), please update your code.")},setEulerFromQuaternion:function(e,t){console.error("REMOVED: Vector3's setEulerFromQuaternion: has been removed in favor of Euler.setFromQuaternion(), please update your code.")},getPositionFromMatrix:function(e){console.warn("DEPRECATED: Vector3's .getPositionFromMatrix() has been renamed to .setFromMatrixPosition(). Please update your code.");return this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){console.warn("DEPRECATED: Vector3's .getScaleFromMatrix() has been renamed to .setFromMatrixScale(). Please update your code.");return this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){console.warn("DEPRECATED: Vector3's .getColumnFromMatrix() has been renamed to .setFromMatrixColumn(). Please update your code.");return this.setFromMatrixColumn(e,t)},setFromMatrixPosition:function(e){this.x=e.elements[12];this.y=e.elements[13];this.z=e.elements[14];return this},setFromMatrixScale:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),n=this.set(e.elements[4],e.elements[5],e.elements[6]).length();e=this.set(e.elements[8],e.elements[9],e.elements[10]).length();this.x=t;this.y=n;this.z=e;return this},setFromMatrixColumn:function(e,t){var n=4*e,r=t.elements;this.x=r[n];this.y=r[n+1];this.z=r[n+2];return this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e){this.x=e[0];this.y=e[1];this.z=e[2];return this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new n.Vector3(this.x,this.y,this.z)}};n.Box3=function(e,t){this.min=void 0!==e?e:new n.Vector3(Infinity,Infinity,Infinity);this.max=void 0!==t?t:new n.Vector3(-Infinity,-Infinity,-Infinity)};n.Box3.prototype={constructor:n.Box3,set:function(e,t){this.min.copy(e);this.max.copy(t);return this},addPoint:function(e){e.x<this.min.x?this.min.x=e.x:e.x>this.max.x&&(this.max.x=e.x);e.y<this.min.y?this.min.y=e.y:e.y>this.max.y&&(this.max.y=e.y);e.z<this.min.z?this.min.z=e.z:e.z>this.max.z&&(this.max.z=e.z)},setFromPoints:function(e){if(0<e.length){var t=e[0];this.min.copy(t);this.max.copy(t);for(var t=1,n=e.length;t<n;t++)this.addPoint(e[t])}else this.makeEmpty();return this},setFromCenterAndSize:function(){var e=new n.Vector3;return function(t,n){var r=e.copy(n).multiplyScalar(.5);this.min.copy(t).sub(r);this.max.copy(t).add(r);return this}}(),setFromObject:function(){var e=new n.Vector3;return function(t){var n=this;t.updateMatrixWorld(!0);this.makeEmpty();t.traverse(function(t){if(void 0!==t.geometry&&void 0!==t.geometry.vertices)for(var r=t.geometry.vertices,i=0,s=r.length;i<s;i++)e.copy(r[i]),e.applyMatrix4(t.matrixWorld),n.expandByPoint(e)});return this}}(),copy:function(e){this.min.copy(e.min);this.max.copy(e.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(e){return(e||new n.Vector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){return(e||new n.Vector3).subVectors(this.max,this.min)},expandByPoint:function(e){this.min.min(e);this.max.max(e);return this},expandByVector:function(e){this.min.sub(e);this.max.add(e);return this},expandByScalar:function(e){this.min.addScalar(-e);this.max.addScalar(e);return this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z?!1:!0},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z?!0:!1},getParameter:function(e,t){return(t||new n.Vector3).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z?!1:!0},clampPoint:function(e,t){return(t||new n.Vector3).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new n.Vector3;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new n.Vector3;return function(t){t=t||new n.Sphere;t.center=this.center();t.radius=.5*this.size(e).length();return t}}(),intersect:function(e){this.min.max(e.min);this.max.min(e.max);return this},union:function(e){this.min.min(e.min);this.max.max(e.max);return this},applyMatrix4:function(){var e=[new n.Vector3,new n.Vector3,new n.Vector3,new n.Vector3,new n.Vector3,new n.Vector3,new n.Vector3,new n.Vector3];return function(t){e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t);e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t);e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t);e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t);e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t);e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t);e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t);e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t);this.makeEmpty();this.setFromPoints(e);return this}}(),translate:function(e){this.min.add(e);this.max.add(e);return this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new n.Box3).copy(this)}};n.Sphere=function(e,t){this.center=void 0!==e?e:new n.Vector3;this.radius=void 0!==t?t:0};n.Sphere.prototype={constructor:n.Sphere,set:function(e,t){this.center.copy(e);this.radius=t;return this},setFromPoints:function(){var e=new n.Box3;return function(t,n){var r=this.center;void 0!==n?r.copy(n):e.setFromPoints(t).center(r);for(var i=0,s=0,o=t.length;s<o;s++)i=Math.max(i,r.distanceToSquared(t[s]));this.radius=Math.sqrt(i);return this}}(),copy:function(e){this.center.copy(e.center);this.radius=e.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},clampPoint:function(e,t){var r=this.center.distanceToSquared(e),i=t||new n.Vector3;i.copy(e);r>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center));return i},getBoundingBox:function(e){e=e||new n.Box3;e.set(this.center,this.center);e.expandByScalar(this.radius);return e},applyMatrix4:function(e){this.center.applyMatrix4(e);this.radius*=e.getMaxScaleOnAxis();return this},translate:function(e){this.center.add(e);return this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius},clone:function(){return(new n.Sphere).copy(this)}};n.Euler=function(e,t,r,i){this._x=e||0;this._y=t||0;this._z=r||0;this._order=i||n.Euler.DefaultOrder};n.Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");n.Euler.DefaultOrder="XYZ";n.Euler.prototype={constructor:n.Euler,_x:0,_y:0,_z:0,_order:n.Euler.DefaultOrder,_quaternion:void 0,_updateQuaternion:function(){void 0!==this._quaternion&&this._quaternion.setFromEuler(this,!1)},get x(){return this._x},set x(e){this._x=e;this._updateQuaternion()},get y(){return this._y},set y(e){this._y=e;this._updateQuaternion()},get z(){return this._z},set z(e){this._z=e;this._updateQuaternion()},get order(){return this._order},set order(e){this._order=e;this._updateQuaternion()},set:function(e,t,n,r){this._x=e;this._y=t;this._z=n;this._order=r||this._order;this._updateQuaternion();return this},copy:function(e){this._x=e._x;this._y=e._y;this._z=e._z;this._order=e._order;this._updateQuaternion();return this},setFromRotationMatrix:function(e,t){function n(e){return Math.min(Math.max(e,-1),1)}var r=e.elements,i=r[0],s=r[4],o=r[8],u=r[1],a=r[5],f=r[9],l=r[2],c=r[6],r=r[10];t=t||this._order;"XYZ"===t?(this._y=Math.asin(n(o)),.99999>Math.abs(o)?(this._x=Math.atan2(-f,r),this._z=Math.atan2(-s,i)):(this._x=Math.atan2(c,a),this._z=0)):"YXZ"===t?(this._x=Math.asin(-n(f)),.99999>Math.abs(f)?(this._y=Math.atan2(o,r),this._z=Math.atan2(u,a)):(this._y=Math.atan2(-l,i),this._z=0)):"ZXY"===t?(this._x=Math.asin(n(c)),.99999>Math.abs(c)?(this._y=Math.atan2(-l,r),this._z=Math.atan2(-s,a)):(this._y=0,this._z=Math.atan2(u,i))):"ZYX"===t?(this._y=Math.asin(-n(l)),.99999>Math.abs(l)?(this._x=Math.atan2(c,r),this._z=Math.atan2(u,i)):(this._x=0,this._z=Math.atan2(-s,a))):"YZX"===t?(this._z=Math.asin(n(u)),.99999>Math.abs(u)?(this._x=Math.atan2(-f,a),this._y=Math.atan2(-l,i)):(this._x=0,this._y=Math.atan2(o,r))):"XZY"===t?(this._z=Math.asin(-n(s)),.99999>Math.abs(s)?(this._x=Math.atan2(c,a),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-f,r),this._y=0)):console.warn("WARNING: Euler.setFromRotationMatrix() given unsupported order: "+t);this._order=t;this._updateQuaternion();return this},setFromQuaternion:function(e,t,n){function r(e){return Math.min(Math.max(e,-1),1)}var i=e.x*e.x,s=e.y*e.y,o=e.z*e.z,u=e.w*e.w;t=t||this._order;"XYZ"===t?(this._x=Math.atan2(2*(e.x*e.w-e.y*e.z),u-i-s+o),this._y=Math.asin(r(2*(e.x*e.z+e.y*e.w))),this._z=Math.atan2(2*(e.z*e.w-e.x*e.y),u+i-s-o)):"YXZ"===t?(this._x=Math.asin(r(2*(e.x*e.w-e.y*e.z))),this._y=Math.atan2(2*(e.x*e.z+e.y*e.w),u-i-s+o),this._z=Math.atan2(2*(e.x*e.y+e.z*e.w),u-i+s-o)):"ZXY"===t?(this._x=Math.asin(r(2*(e.x*e.w+e.y*e.z))),this._y=Math.atan2(2*(e.y*e.w-e.z*e.x),u-i-s+o),this._z=Math.atan2(2*(e.z*e.w-e.x*e.y),u-i+s-o)):"ZYX"===t?(this._x=Math.atan2(2*(e.x*e.w+e.z*e.y),u-i-s+o),this._y=Math.asin(r(2*(e.y*e.w-e.x*e.z))),this._z=Math.atan2(2*(e.x*e.y+e.z*e.w),u+i-s-o)):"YZX"===t?(this._x=Math.atan2(2*(e.x*e.w-e.z*e.y),u-i+s-o),this._y=Math.atan2(2*(e.y*e.w-e.x*e.z),u+i-s-o),this._z=Math.asin(r(2*(e.x*e.y+e.z*e.w)))):"XZY"===t?(this._x=Math.atan2(2*(e.x*e.w+e.y*e.z),u-i+s-o),this._y=Math.atan2(2*(e.x*e.z+e.y*e.w),u+i-s-o),this._z=Math.asin(r(2*(e.z*e.w-e.x*e.y)))):console.warn("WARNING: Euler.setFromQuaternion() given unsupported order: "+t);this._order=t;!1!==n&&this._updateQuaternion();return this},reorder:function(){var e=new n.Quaternion;return function(t){e.setFromEuler(this);this.setFromQuaternion(e,t)}}(),fromArray:function(e){this._x=e[0];this._y=e[1];this._z=e[2];void 0!==e[3]&&(this._order=e[3]);this._updateQuaternion();return this},toArray:function(){return[this._x,this._y,this._z,this._order]},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},clone:function(){return new n.Euler(this._x,this._y,this._z,this._order)}};n.Matrix3=function(e,t,n,r,i,s,o,u,a){this.elements=new Float32Array(9);this.set(void 0!==e?e:1,t||0,n||0,r||0,void 0!==i?i:1,s||0,o||0,u||0,void 0!==a?a:1)};n.Matrix3.prototype={constructor:n.Matrix3,set:function(e,t,n,r,i,s,o,u,a){var f=this.elements;f[0]=e;f[3]=t;f[6]=n;f[1]=r;f[4]=i;f[7]=s;f[2]=o;f[5]=u;f[8]=a;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(e){e=e.elements;this.set(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]);return this},multiplyVector3:function(e){console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return e.applyMatrix3(this)},multiplyVector3Array:function(){var e=new n.Vector3;return function(t){for(var n=0,r=t.length;n<r;n+=3)e.x=t[n],e.y=t[n+1],e.z=t[n+2],e.applyMatrix3(this),t[n]=e.x,t[n+1]=e.y,t[n+2]=e.z;return t}}(),multiplyScalar:function(e){var t=this.elements;t[0]*=e;t[3]*=e;t[6]*=e;t[1]*=e;t[4]*=e;t[7]*=e;t[2]*=e;t[5]*=e;t[8]*=e;return this},determinant:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=e[6],a=e[7],e=e[8];return t*s*e-t*o*a-n*i*e+n*o*u+r*i*a-r*s*u},getInverse:function(e,t){var n=e.elements,r=this.elements;r[0]=n[10]*n[5]-n[6]*n[9];r[1]=-n[10]*n[1]+n[2]*n[9];r[2]=n[6]*n[1]-n[2]*n[5];r[3]=-n[10]*n[4]+n[6]*n[8];r[4]=n[10]*n[0]-n[2]*n[8];r[5]=-n[6]*n[0]+n[2]*n[4];r[6]=n[9]*n[4]-n[5]*n[8];r[7]=-n[9]*n[0]+n[1]*n[8];r[8]=n[5]*n[0]-n[1]*n[4];n=n[0]*r[0]+n[1]*r[3]+n[2]*r[6];if(0===n){if(t)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/n);return this},transpose:function(){var e,t=this.elements;e=t[1];t[1]=t[3];t[3]=e;e=t[2];t[2]=t[6];t[6]=e;e=t[5];t[5]=t[7];t[7]=e;return this},getNormalMatrix:function(e){this.getInverse(e).transpose();return this},transposeIntoArray:function(e){var t=this.elements;e[0]=t[0];e[1]=t[3];e[2]=t[6];e[3]=t[1];e[4]=t[4];e[5]=t[7];e[6]=t[2];e[7]=t[5];e[8]=t[8];return this},fromArray:function(e){this.elements.set(e);return this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},clone:function(){var e=this.elements;return new n.Matrix3(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])}};n.Matrix4=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){var m=this.elements=new Float32Array(16);m[0]=void 0!==e?e:1;m[4]=t||0;m[8]=n||0;m[12]=r||0;m[1]=i||0;m[5]=void 0!==s?s:1;m[9]=o||0;m[13]=u||0;m[2]=a||0;m[6]=f||0;m[10]=void 0!==l?l:1;m[14]=c||0;m[3]=h||0;m[7]=p||0;m[11]=d||0;m[15]=void 0!==v?v:1};n.Matrix4.prototype={constructor:n.Matrix4,set:function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){var m=this.elements;m[0]=e;m[4]=t;m[8]=n;m[12]=r;m[1]=i;m[5]=s;m[9]=o;m[13]=u;m[2]=a;m[6]=f;m[10]=l;m[14]=c;m[3]=h;m[7]=p;m[11]=d;m[15]=v;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(e){this.elements.set(e.elements);return this},extractPosition:function(e){console.warn("DEPRECATED: Matrix4's .extractPosition() has been renamed to .copyPosition().");return this.copyPosition(e)},copyPosition:function(e){var t=this.elements;e=e.elements;t[12]=e[12];t[13]=e[13];t[14]=e[14];return this},extractRotation:function(){var e=new n.Vector3;return function(t){var n=this.elements;t=t.elements;var r=1/e.set(t[0],t[1],t[2]).length(),i=1/e.set(t[4],t[5],t[6]).length(),s=1/e.set(t[8],t[9],t[10]).length();n[0]=t[0]*r;n[1]=t[1]*r;n[2]=t[2]*r;n[4]=t[4]*i;n[5]=t[5]*i;n[6]=t[6]*i;n[8]=t[8]*s;n[9]=t[9]*s;n[10]=t[10]*s;return this}}(),makeRotationFromEuler:function(e){!1===e instanceof n.Euler&&console.error("ERROR: Matrix's .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var t=this.elements,r=e.x,i=e.y,s=e.z,o=Math.cos(r),r=Math.sin(r),u=Math.cos(i),i=Math.sin(i),a=Math.cos(s),s=Math.sin(s);if("XYZ"===e.order){e=o*a;var f=o*s,l=r*a,c=r*s;t[0]=u*a;t[4]=-u*s;t[8]=i;t[1]=f+l*i;t[5]=e-c*i;t[9]=-r*u;t[2]=c-e*i;t[6]=l+f*i;t[10]=o*u}else"YXZ"===e.order?(e=u*a,f=u*s,l=i*a,c=i*s,t[0]=e+c*r,t[4]=l*r-f,t[8]=o*i,t[1]=o*s,t[5]=o*a,t[9]=-r,t[2]=f*r-l,t[6]=c+e*r,t[10]=o*u):"ZXY"===e.order?(e=u*a,f=u*s,l=i*a,c=i*s,t[0]=e-c*r,t[4]=-o*s,t[8]=l+f*r,t[1]=f+l*r,t[5]=o*a,t[9]=c-e*r,t[2]=-o*i,t[6]=r,t[10]=o*u):"ZYX"===e.order?(e=o*a,f=o*s,l=r*a,c=r*s,t[0]=u*a,t[4]=l*i-f,t[8]=e*i+c,t[1]=u*s,t[5]=c*i+e,t[9]=f*i-l,t[2]=-i,t[6]=r*u,t[10]=o*u):"YZX"===e.order?(e=o*u,f=o*i,l=r*u,c=r*i,t[0]=u*a,t[4]=c-e*s,t[8]=l*s+f,t[1]=s,t[5]=o*a,t[9]=-r*a,t[2]=-i*a,t[6]=f*s+l,t[10]=e-c*s):"XZY"===e.order&&(e=o*u,f=o*i,l=r*u,c=r*i,t[0]=u*a,t[4]=-s,t[8]=i*a,t[1]=e*s+c,t[5]=o*a,t[9]=f*s-l,t[2]=l*s-f,t[6]=r*a,t[10]=c*s+e);t[3]=0;t[7]=0;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return this},setRotationFromQuaternion:function(e){console.warn("DEPRECATED: Matrix4's .setRotationFromQuaternion() has been deprecated in favor of makeRotationFromQuaternion.  Please update your code.");return this.makeRotationFromQuaternion(e)},makeRotationFromQuaternion:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z,s=e.w,o=n+n,u=r+r,a=i+i;e=n*o;var f=n*u,n=n*a,l=r*u,r=r*a,i=i*a,o=s*o,u=s*u,s=s*a;t[0]=1-(l+i);t[4]=f-s;t[8]=n+u;t[1]=f+s;t[5]=1-(e+i);t[9]=r-o;t[2]=n-u;t[6]=r+o;t[10]=1-(e+l);t[3]=0;t[7]=0;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return this},lookAt:function(){var e=new n.Vector3,t=new n.Vector3,r=new n.Vector3;return function(n,i,s){var o=this.elements;r.subVectors(n,i).normalize();0===r.length()&&(r.z=1);e.crossVectors(s,r).normalize();0===e.length()&&(r.x+=1e-4,e.crossVectors(s,r).normalize());t.crossVectors(r,e);o[0]=e.x;o[4]=t.x;o[8]=r.x;o[1]=e.y;o[5]=t.y;o[9]=r.y;o[2]=e.z;o[6]=t.z;o[10]=r.z;return this}}(),multiply:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,s=n[0],o=n[4],u=n[8],a=n[12],f=n[1],l=n[5],c=n[9],h=n[13],p=n[2],d=n[6],v=n[10],m=n[14],g=n[3],y=n[7],b=n[11],n=n[15],w=r[0],E=r[4],S=r[8],x=r[12],T=r[1],N=r[5],C=r[9],k=r[13],L=r[2],A=r[6],O=r[10],M=r[14],_=r[3],D=r[7],P=r[11],r=r[15];i[0]=s*w+o*T+u*L+a*_;i[4]=s*E+o*N+u*A+a*D;i[8]=s*S+o*C+u*O+a*P;i[12]=s*x+o*k+u*M+a*r;i[1]=f*w+l*T+c*L+h*_;i[5]=f*E+l*N+c*A+h*D;i[9]=f*S+l*C+c*O+h*P;i[13]=f*x+l*k+c*M+h*r;i[2]=p*w+d*T+v*L+m*_;i[6]=p*E+d*N+v*A+m*D;i[10]=p*S+d*C+v*O+m*P;i[14]=p*x+d*k+v*M+m*r;i[3]=g*w+y*T+b*L+n*_;i[7]=g*E+y*N+b*A+n*D;i[11]=g*S+y*C+b*O+n*P;i[15]=g*x+y*k+b*M+n*r;return this},multiplyToArray:function(e,t,n){var r=this.elements;this.multiplyMatrices(e,t);n[0]=r[0];n[1]=r[1];n[2]=r[2];n[3]=r[3];n[4]=r[4];n[5]=r[5];n[6]=r[6];n[7]=r[7];n[8]=r[8];n[9]=r[9];n[10]=r[10];n[11]=r[11];n[12]=r[12];n[13]=r[13];n[14]=r[14];n[15]=r[15];return this},multiplyScalar:function(e){var t=this.elements;t[0]*=e;t[4]*=e;t[8]*=e;t[12]*=e;t[1]*=e;t[5]*=e;t[9]*=e;t[13]*=e;t[2]*=e;t[6]*=e;t[10]*=e;t[14]*=e;t[3]*=e;t[7]*=e;t[11]*=e;t[15]*=e;return this},multiplyVector3:function(e){console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");return e.applyProjection(this)},multiplyVector4:function(e){console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return e.applyMatrix4(this)},multiplyVector3Array:function(){var e=new n.Vector3;return function(t){for(var n=0,r=t.length;n<r;n+=3)e.x=t[n],e.y=t[n+1],e.z=t[n+2],e.applyProjection(this),t[n]=e.x,t[n+1]=e.y,t[n+2]=e.z;return t}}(),rotateAxis:function(e){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");e.transformDirection(this)},crossVector:function(e){console.warn("DEPRECATED: Matrix4's .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return e.applyMatrix4(this)},determinant:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],s=e[1],o=e[5],u=e[9],a=e[13],f=e[2],l=e[6],c=e[10],h=e[14];return e[3]*(+i*u*l-r*a*l-i*o*c+n*a*c+r*o*h-n*u*h)+e[7]*(+t*u*h-t*a*c+i*s*c-r*s*h+r*a*f-i*u*f)+e[11]*(+t*a*l-t*o*h-i*s*l+n*s*h+i*o*f-n*a*f)+e[15]*(-r*o*f-t*u*l+t*o*c+r*s*l-n*s*c+n*u*f)},transpose:function(){var e=this.elements,t;t=e[1];e[1]=e[4];e[4]=t;t=e[2];e[2]=e[8];e[8]=t;t=e[6];e[6]=e[9];e[9]=t;t=e[3];e[3]=e[12];e[12]=t;t=e[7];e[7]=e[13];e[13]=t;t=e[11];e[11]=e[14];e[14]=t;return this},flattenToArray:function(e){var t=this.elements;e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[4]=t[4];e[5]=t[5];e[6]=t[6];e[7]=t[7];e[8]=t[8];e[9]=t[9];e[10]=t[10];e[11]=t[11];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15];return e},flattenToArrayOffset:function(e,t){var n=this.elements;e[t]=n[0];e[t+1]=n[1];e[t+2]=n[2];e[t+3]=n[3];e[t+4]=n[4];e[t+5]=n[5];e[t+6]=n[6];e[t+7]=n[7];e[t+8]=n[8];e[t+9]=n[9];e[t+10]=n[10];e[t+11]=n[11];e[t+12]=n[12];e[t+13]=n[13];e[t+14]=n[14];e[t+15]=n[15];return e},getPosition:function(){var e=new n.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var t=this.elements;return e.set(t[12],t[13],t[14])}}(),setPosition:function(e){var t=this.elements;t[12]=e.x;t[13]=e.y;t[14]=e.z;return this},getInverse:function(e,t){var n=this.elements,r=e.elements,i=r[0],s=r[4],o=r[8],u=r[12],a=r[1],f=r[5],l=r[9],c=r[13],h=r[2],p=r[6],d=r[10],v=r[14],m=r[3],g=r[7],y=r[11],r=r[15];n[0]=l*v*g-c*d*g+c*p*y-f*v*y-l*p*r+f*d*r;n[4]=u*d*g-o*v*g-u*p*y+s*v*y+o*p*r-s*d*r;n[8]=o*c*g-u*l*g+u*f*y-s*c*y-o*f*r+s*l*r;n[12]=u*l*p-o*c*p-u*f*d+s*c*d+o*f*v-s*l*v;n[1]=c*d*m-l*v*m-c*h*y+a*v*y+l*h*r-a*d*r;n[5]=o*v*m-u*d*m+u*h*y-i*v*y-o*h*r+i*d*r;n[9]=u*l*m-o*c*m-u*a*y+i*c*y+o*a*r-i*l*r;n[13]=o*c*h-u*l*h+u*a*d-i*c*d-o*a*v+i*l*v;n[2]=f*v*m-c*p*m+c*h*g-a*v*g-f*h*r+a*p*r;n[6]=u*p*m-s*v*m-u*h*g+i*v*g+s*h*r-i*p*r;n[10]=s*c*m-u*f*m+u*a*g-i*c*g-s*a*r+i*f*r;n[14]=u*f*h-s*c*h-u*a*p+i*c*p+s*a*v-i*f*v;n[3]=l*p*m-f*d*m-l*h*g+a*d*g+f*h*y-a*p*y;n[7]=s*d*m-o*p*m+o*h*g-i*d*g-s*h*y+i*p*y;n[11]=o*f*m-s*l*m-o*a*g+i*l*g+s*a*y-i*f*y;n[15]=s*l*h-o*f*h+o*a*p-i*l*p-s*a*d+i*f*d;n=i*n[0]+a*n[4]+h*n[8]+m*n[12];if(0==n){if(t)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/n);return this},translate:function(e){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},rotateX:function(e){console.warn("DEPRECATED: Matrix4's .rotateX() has been removed.")},rotateY:function(e){console.warn("DEPRECATED: Matrix4's .rotateY() has been removed.")},rotateZ:function(e){console.warn("DEPRECATED: Matrix4's .rotateZ() has been removed.")},rotateByAxis:function(e,t){console.warn("DEPRECATED: Matrix4's .rotateByAxis() has been removed.")},scale:function(e){var t=this.elements,n=e.x,r=e.y;e=e.z;t[0]*=n;t[4]*=r;t[8]*=e;t[1]*=n;t[5]*=r;t[9]*=e;t[2]*=n;t[6]*=r;t[10]*=e;t[3]*=n;t[7]*=r;t[11]*=e;return this},getMaxScaleOnAxis:function(){var e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],Math.max(e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10])))},makeTranslation:function(e,t,n){this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1);return this},makeRotationX:function(e){var t=Math.cos(e);e=Math.sin(e);this.set(1,0,0,0,0,t,-e,0,0,e,t,0,0,0,0,1);return this},makeRotationY:function(e){var t=Math.cos(e);e=Math.sin(e);this.set(t,0,e,0,0,1,0,0,-e,0,t,0,0,0,0,1);return this},makeRotationZ:function(e){var t=Math.cos(e);e=Math.sin(e);this.set(t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,s=e.x,o=e.y,u=e.z,a=i*s,f=i*o;this.set(a*s+n,a*o-r*u,a*u+r*o,0,a*o+r*u,f*o+n,f*u-r*s,0,a*u-r*o,f*u+r*s,i*u*u+n,0,0,0,0,1);return this},makeScale:function(e,t,n){this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1);return this},compose:function(e,t,n){this.makeRotationFromQuaternion(t);this.scale(n);this.setPosition(e);return this},decompose:function(){var e=new n.Vector3,t=new n.Matrix4;return function(n,r,i){var s=this.elements,o=e.set(s[0],s[1],s[2]).length(),u=e.set(s[4],s[5],s[6]).length(),a=e.set(s[8],s[9],s[10]).length();0>this.determinant()&&(o=-o);n.x=s[12];n.y=s[13];n.z=s[14];t.elements.set(this.elements);n=1/o;var s=1/u,f=1/a;t.elements[0]*=n;t.elements[1]*=n;t.elements[2]*=n;t.elements[4]*=s;t.elements[5]*=s;t.elements[6]*=s;t.elements[8]*=f;t.elements[9]*=f;t.elements[10]*=f;r.setFromRotationMatrix(t);i.x=o;i.y=u;i.z=a;return this}}(),makeFrustum:function(e,t,n,r,i,s){var o=this.elements;o[0]=2*i/(t-e);o[4]=0;o[8]=(t+e)/(t-e);o[12]=0;o[1]=0;o[5]=2*i/(r-n);o[9]=(r+n)/(r-n);o[13]=0;o[2]=0;o[6]=0;o[10]=-(s+i)/(s-i);o[14]=-2*s*i/(s-i);o[3]=0;o[7]=0;o[11]=-1;o[15]=0;return this},makePerspective:function(e,t,r,i){e=r*Math.tan(n.Math.degToRad(.5*e));var s=-e;return this.makeFrustum(s*t,e*t,s,e,r,i)},makeOrthographic:function(e,t,n,r,i,s){var o=this.elements,u=t-e,a=n-r,f=s-i;o[0]=2/u;o[4]=0;o[8]=0;o[12]=-((t+e)/u);o[1]=0;o[5]=2/a;o[9]=0;o[13]=-((n+r)/a);o[2]=0;o[6]=0;o[10]=-2/f;o[14]=-((s+i)/f);o[3]=0;o[7]=0;o[11]=0;o[15]=1;return this},fromArray:function(e){this.elements.set(e);return this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},clone:function(){var e=this.elements;return new n.Matrix4(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])}};n.Object3D=function(){this.id=n.Object3DIdCount++;this.uuid=n.Math.generateUUID();this.name="";this.parent=void 0;this.children=[];this.up=new n.Vector3(0,1,0);this.position=new n.Vector3;this._rotation=new n.Euler;this._quaternion=new n.Quaternion;this.scale=new n.Vector3(1,1,1);this._rotation._quaternion=this.quaternion;this._quaternion._euler=this.rotation;this.renderDepth=null;this.rotationAutoUpdate=!0;this.matrix=new n.Matrix4;this.matrixWorld=new n.Matrix4;this.visible=this.matrixWorldNeedsUpdate=this.matrixAutoUpdate=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.userData={}};n.Object3D.prototype={constructor:n.Object3D,get rotation(){return this._rotation},set rotation(e){this._rotation=e;this._rotation._quaternion=this._quaternion;this._quaternion._euler=this._rotation;this._rotation._updateQuaternion()},get quaternion(){return this._quaternion},set quaternion(e){this._quaternion=e;this._quaternion._euler=this._rotation;this._rotation._quaternion=this._quaternion;this._quaternion._updateEuler()},get eulerOrder(){console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order.");return this.rotation.order},set eulerOrder(e){console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order.");this.rotation.order=e},get useQuaternion(){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(e){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix);this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new n.Quaternion;return function(t,n){e.setFromAxisAngle(t,n);this.quaternion.multiply(e);return this}}(),rotateX:function(){var e=new n.Vector3(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new n.Vector3(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new n.Vector3(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new n.Vector3;return function(t,n){e.copy(t);e.applyQuaternion(this.quaternion);this.position.add(e.multiplyScalar(n));return this}}(),translate:function(e,t){console.warn("DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed.");return this.translateOnAxis(t,e)},translateX:function(){var e=new n.Vector3(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new n.Vector3(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new n.Vector3(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new n.Matrix4;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new n.Matrix4;return function(t){e.lookAt(t,this.position,this.up);this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(e===this)console.warn("THREE.Object3D.add: An object can't be added as a child of itself.");else if(e instanceof n.Object3D){void 0!==e.parent&&e.parent.remove(e);e.parent=this;e.dispatchEvent({type:"added"});this.children.push(e);for(var t=this;void 0!==t.parent;)t=t.parent;void 0!==t&&t instanceof n.Scene&&t.__addObject(e)}},remove:function(e){var t=this.children.indexOf(e);if(-1!==t){e.parent=void 0;e.dispatchEvent({type:"removed"});this.children.splice(t,1);for(t=this;void 0!==t.parent;)t=t.parent;void 0!==t&&t instanceof n.Scene&&t.__removeObject(e)}},traverse:function(e){e(this);for(var t=0,n=this.children.length;t<n;t++)this.children[t].traverse(e)},getObjectById:function(e,t){for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n];if(i.id===e||!0===t&&(i=i.getObjectById(e,t),void 0!==i))return i}},getObjectByName:function(e,t){for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n];if(i.name===e||!0===t&&(i=i.getObjectByName(e,t),void 0!==i))return i}},getChildByName:function(e,t){console.warn("DEPRECATED: Object3D's .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(e,t)},getDescendants:function(e){void 0===e&&(e=[]);Array.prototype.push.apply(e,this.children);for(var t=0,n=this.children.length;t<n;t++)this.children[t].getDescendants(e);return e},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===e)void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0;for(var t=0,n=this.children.length;t<n;t++)this.children[t].updateMatrixWorld(e)},clone:function(e,t){void 0===e&&(e=new n.Object3D);void 0===t&&(t=!0);e.name=this.name;e.up.copy(this.up);e.position.copy(this.position);e.quaternion.copy(this.quaternion);e.scale.copy(this.scale);e.renderDepth=this.renderDepth;e.rotationAutoUpdate=this.rotationAutoUpdate;e.matrix.copy(this.matrix);e.matrixWorld.copy(this.matrixWorld);e.matrixAutoUpdate=this.matrixAutoUpdate;e.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate;e.visible=this.visible;e.castShadow=this.castShadow;e.receiveShadow=this.receiveShadow;e.frustumCulled=this.frustumCulled;e.userData=JSON.parse(JSON.stringify(this.userData));if(!0===t)for(var r=0;r<this.children.length;r++)e.add(this.children[r].clone());return e}};n.EventDispatcher.prototype.apply(n.Object3D.prototype);n.Object3DIdCount=0;n.Camera=function(){n.Object3D.call(this);this.matrixWorldInverse=new n.Matrix4;this.projectionMatrix=new n.Matrix4};n.Camera.prototype=Object.create(n.Object3D.prototype);n.Camera.prototype.lookAt=function(){var e=new n.Matrix4;return function(t){e.lookAt(this.position,t,this.up);this.quaternion.setFromRotationMatrix(e)}}();n.Camera.prototype.clone=function(e){void 0===e&&(e=new n.Camera);n.Object3D.prototype.clone.call(this,e);e.matrixWorldInverse.copy(this.matrixWorldInverse);e.projectionMatrix.copy(this.projectionMatrix);return e};n.PerspectiveCamera=function(e,t,r,i){n.Camera.call(this);this.fov=void 0!==e?e:50;this.aspect=void 0!==t?t:1;this.near=void 0!==r?r:.1;this.far=void 0!==i?i:2e3;this.updateProjectionMatrix()};n.PerspectiveCamera.prototype=Object.create(n.Camera.prototype);n.PerspectiveCamera.prototype.setLens=function(e,t){void 0===t&&(t=24);this.fov=2*n.Math.radToDeg(Math.atan(t/(2*e)));this.updateProjectionMatrix()};n.PerspectiveCamera.prototype.setViewOffset=function(e,t,n,r,i,s){this.fullWidth=e;this.fullHeight=t;this.x=n;this.y=r;this.width=i;this.height=s;this.updateProjectionMatrix()};n.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var e=this.fullWidth/this.fullHeight,t=Math.tan(n.Math.degToRad(.5*this.fov))*this.near,r=-t,i=e*r,e=Math.abs(e*t-i),r=Math.abs(t-r);this.projectionMatrix.makeFrustum(i+this.x*e/this.fullWidth,i+(this.x+this.width)*e/this.fullWidth,t-(this.y+this.height)*r/this.fullHeight,t-this.y*r/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)};n.PerspectiveCamera.prototype.clone=function(){var e=new n.PerspectiveCamera;n.Camera.prototype.clone.call(this,e);e.fov=this.fov;e.aspect=this.aspect;e.near=this.near;e.far=this.far;return e};n.Ray=function(e,t){this.origin=void 0!==e?e:new n.Vector3;this.direction=void 0!==t?t:new n.Vector3};n.Ray.prototype={constructor:n.Ray,set:function(e,t){this.origin.copy(e);this.direction.copy(t);return this},copy:function(e){this.origin.copy(e.origin);this.direction.copy(e.direction);return this},at:function(e,t){return(t||new n.Vector3).copy(this.direction).multiplyScalar(e).add(this.origin)},recast:function(){var e=new n.Vector3;return function(t){this.origin.copy(this.at(t,e));return this}}(),closestPointToPoint:function(e,t){var r=t||new n.Vector3;r.subVectors(e,this.origin);var i=r.dot(this.direction);return 0>i?r.copy(this.origin):r.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(){var e=new n.Vector3;return function(t){var n=e.subVectors(t,this.origin).dot(this.direction);if(0>n)return this.origin.distanceTo(t);e.copy(this.direction).multiplyScalar(n).add(this.origin);return e.distanceTo(t)}}(),distanceSqToSegment:function(e,t,n,r){var i=e.clone().add(t).multiplyScalar(.5),s=t.clone().sub(e).normalize(),o=.5*e.distanceTo(t),u=this.origin.clone().sub(i);e=-this.direction.dot(s);t=u.dot(this.direction);var a=-u.dot(s),f=u.lengthSq(),l=Math.abs(1-e*e),c,h;0<=l?(u=e*a-t,c=e*t-a,h=o*l,0<=u?c>=-h?c<=h?(o=1/l,u*=o,c*=o,e=u*(u+e*c+2*t)+c*(e*u+c+2*a)+f):(c=o,u=Math.max(0,-(e*c+t)),e=-u*u+c*(c+2*a)+f):(c=-o,u=Math.max(0,-(e*c+t)),e=-u*u+c*(c+2*a)+f):c<=-h?(u=Math.max(0,-(-e*o+t)),c=0<u?-o:Math.min(Math.max(-o,-a),o),e=-u*u+c*(c+2*a)+f):c<=h?(u=0,c=Math.min(Math.max(-o,-a),o),e=c*(c+2*a)+f):(u=Math.max(0,-(e*o+t)),c=0<u?o:Math.min(Math.max(-o,-a),o),e=-u*u+c*(c+2*a)+f)):(c=0<e?-o:o,u=Math.max(0,-(e*c+t)),e=-u*u+c*(c+2*a)+f);n&&n.copy(this.direction.clone().multiplyScalar(u).add(this.origin));r&&r.copy(s.clone().multiplyScalar(c).add(i));return e},isIntersectionSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},isIntersectionPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||0>e.normal.dot(this.direction)*t?!0:!1},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0==t)return 0==e.distanceToPoint(this.origin)?0:null;e=-(this.origin.dot(e.normal)+e.constant)/t;return 0<=e?e:null},intersectPlane:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},isIntersectionBox:function(){var e=new n.Vector3;return function(t){return null!==this.intersectBox(t,e)}}(),intersectBox:function(e,t){var n,r,i,s,o;r=1/this.direction.x;s=1/this.direction.y;o=1/this.direction.z;var u=this.origin;0<=r?(n=(e.min.x-u.x)*r,r*=e.max.x-u.x):(n=(e.max.x-u.x)*r,r*=e.min.x-u.x);0<=s?(i=(e.min.y-u.y)*s,s*=e.max.y-u.y):(i=(e.max.y-u.y)*s,s*=e.min.y-u.y);if(n>s||i>r)return null;if(i>n||n!==n)n=i;if(s<r||r!==r)r=s;0<=o?(i=(e.min.z-u.z)*o,o*=e.max.z-u.z):(i=(e.max.z-u.z)*o,o*=e.min.z-u.z);if(n>o||i>r)return null;if(i>n||n!==n)n=i;if(o<r||r!==r)r=o;return 0>r?null:this.at(0<=n?n:r,t)},intersectTriangle:function(){var e=new n.Vector3,t=new n.Vector3,r=new n.Vector3,i=new n.Vector3;return function(n,s,o,u,a){t.subVectors(s,n);r.subVectors(o,n);i.crossVectors(t,r);s=this.direction.dot(i);if(0<s){if(u)return null;u=1}else if(0>s)u=-1,s=-s;else return null;e.subVectors(this.origin,n);n=u*this.direction.dot(r.crossVectors(e,r));if(0>n)return null;o=u*this.direction.dot(t.cross(e));if(0>o||n+o>s)return null;n=-u*e.dot(i);return 0>n?null:this.at(n/s,a)}}(),applyMatrix4:function(e){this.direction.add(this.origin).applyMatrix4(e);this.origin.applyMatrix4(e);this.direction.sub(this.origin);this.direction.normalize();return this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)},clone:function(){return(new n.Ray).copy(this)}};n.Plane=function(e,t){this.normal=void 0!==e?e:new n.Vector3(1,0,0);this.constant=void 0!==t?t:0};n.Plane.prototype={constructor:n.Plane,set:function(e,t){this.normal.copy(e);this.constant=t;return this},setComponents:function(e,t,n,r){this.normal.set(e,t,n);this.constant=r;return this},setFromNormalAndCoplanarPoint:function(e,t){this.normal.copy(e);this.constant=-t.dot(this.normal);return this},setFromCoplanarPoints:function(){var e=new n.Vector3,t=new n.Vector3;return function(n,r,i){r=e.subVectors(i,r).cross(t.subVectors(n,r)).normalize();this.setFromNormalAndCoplanarPoint(r,n);return this}}(),copy:function(e){this.normal.copy(e.normal);this.constant=e.constant;return this},normalize:function(){var e=1/this.normal.length();this.normal.multiplyScalar(e);this.constant*=e;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var r=this.distanceToPoint(e);return(t||new n.Vector3).copy(this.normal).multiplyScalar(r)},isIntersectionLine:function(e){var t=this.distanceToPoint(e.start);e=this.distanceToPoint(e.end);return 0>t&&0<e||0>e&&0<t},intersectLine:function(){var e=new n.Vector3;return function(t,r){var i=r||new n.Vector3,s=t.delta(e),o=this.normal.dot(s);if(0==o){if(0==this.distanceToPoint(t.start))return i.copy(t.start)}else return o=-(t.start.dot(this.normal)+this.constant)/o,0>o||1<o?void 0:i.copy(s).multiplyScalar(o).add(t.start)}}(),coplanarPoint:function(e){return(e||new n.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new n.Vector3,t=new n.Vector3,r=new n.Matrix3;return function(n,i){var s=i||r.getNormalMatrix(n),s=e.copy(this.normal).applyMatrix3(s),o=this.coplanarPoint(t);o.applyMatrix4(n);this.setFromNormalAndCoplanarPoint(s,o);return this}}(),translate:function(e){this.constant-=e.dot(this.normal);return this},equals:function(e){return e.normal.equals(this.normal)&&e.constant==this.constant},clone:function(){return(new n.Plane).copy(this)}};n.CSS3DObject=function(e){n.Object3D.call(this);this.element=e;this.done=!1;this.element.style.position="absolute";this.addEventListener("removed",function(e){if(null!==this.element.parentNode){this.element.parentNode.removeChild(this.element);for(var t=0,n=this.children.length;t<n;t++)this.children[t].dispatchEvent(e)}})};n.CSS3DObject.prototype=Object.create(n.Object3D.prototype);n.CSS3DSprite=function(e){n.CSS3DObject.call(this,e)};n.CSS3DSprite.prototype=Object.create(n.CSS3DObject.prototype);n.CSS3DRenderer=function(){var e,t,r,i,s=new n.Matrix4,o=document.createElement("div");o.style.overflow="hidden";o.style.WebkitTransformStyle="preserve-3d";o.style.MozTransformStyle="preserve-3d";o.style.oTransformStyle="preserve-3d";o.style.transformStyle="preserve-3d";this.domElement=o;var u=document.createElement("div");u.style.WebkitTransformStyle="preserve-3d";u.style.MozTransformStyle="preserve-3d";u.style.oTransformStyle="preserve-3d";u.style.transformStyle="preserve-3d";o.appendChild(u);this.setClearColor=function(){};this.setSize=function(n,s){e=n;t=s;r=e/2;i=t/2;o.style.width=n+"px";o.style.height=s+"px";u.style.width=n+"px";u.style.height=s+"px"};var a=function(e){return 1e-6>Math.abs(e)?0:e},f=function(){var e=new n.Vector3,t=new n.Vector3,r=new n.Euler,i=new n.Quaternion;r._quaternion=i;i._euler=r;return function(n){n.decompose(e,i,t);return"translate3d(-50%,-50%,0) translate3d("+a(e.x)+"px, "+a(e.y)+"px, "+a(e.z)+"px) rotateX("+a(r.x)+"rad) rotateY("+a(r.y)+"rad) rotateZ("+a(r.z)+"rad) scale3d("+a(t.x)+", "+a(-t.y)+", "+a(t.z)+")"}}(),l=function(e,t){if(e instanceof n.CSS3DObject){var r;e instanceof n.CSS3DSprite?(s.copy(t.matrixWorldInverse),s.transpose(),s.copyPosition(e.matrixWorld),s.scale(e.scale),s.elements[3]=0,s.elements[7]=0,s.elements[11]=0,s.elements[15]=1,r=f(s)):r=f(e.matrixWorld);var i=e.element;i.style.WebkitTransformStyle="preserve-3d";i.style.MozTransformStyle="preserve-3d";i.style.oTransformStyle="preserve-3d";i.style.transformStyle="preserve-3d";i.style.WebkitTransform=r;i.style.MozTransform=r;i.style.oTransform=r;i.style.transform=r;i.parentNode!==u&&u.appendChild(i)}r=0;for(i=e.children.length;r<i;r++)l(e.children[r],t)};this.render=function(e,s){var f=.5/Math.tan(n.Math.degToRad(.5*s.fov))*t;o.style.WebkitPerspective=f+"px";o.style.MozPerspective=f+"px";o.style.oPerspective=f+"px";o.style.perspective=f+"px";e.updateMatrixWorld();void 0===s.parent&&s.updateMatrixWorld();s.matrixWorldInverse.getInverse(s.matrixWorld);var f="translate3d(0,0,"+f+"px)",c;c=s.matrixWorldInverse.elements;c="matrix3d("+a(c[0])+","+a(-c[1])+","+a(c[2])+","+a(c[3])+","+a(c[4])+","+a(-c[5])+","+a(c[6])+","+a(c[7])+","+a(c[8])+","+a(-c[9])+","+a(c[10])+","+a(c[11])+","+a(c[12])+","+a(-c[13])+","+a(c[14])+","+a(c[15])+")";f=f+c+" translate3d("+r+"px,"+i+"px, 0)";u.style.WebkitTransform=f;u.style.MozTransform=f;u.style.oTransform=f;u.style.transform=f;l(e,s)}};var r={isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},cascade:function(){var e,t=Array.prototype.slice.call(arguments);for(e=0;e<t.length;e++)if(void 0!==t[e])return t[e];return!1},hexToRgb:function(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,n,r){return t+t+n+n+r+r});return(e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e))?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}};e.extend(Number.prototype,{absolute:function(){return Math.abs(this)},add:function(){var e=this;Array.prototype.slice.call(arguments).forEach(function(t){e+=t});return e},arcCosine:function(){return Math.acos(this)},arcSine:function(){return Math.asin(this)},arcTangent:function(){return Math.atan(this)},constrain:function(e,t){var n,r,i=this;t=t||0;n=Math.max(e,t);r=Math.min(e,t);i=Math.min(i,n);return i=Math.max(i,r)},cosine:function(){return Math.cos(this)},degreesToDirection:function(){var e="N NNE NE NEE E SEE SE SSE S SSW SW SWW W NWW NW NNW N".split(" ");return e[this.scale(0,360,0,e.length-1).round()]},degreesToRadians:function(){return this*Math.PI/180},divide:function(){var e=this;Array.prototype.slice.call(arguments).forEach(function(t){e/=t});return e},isBetween:function(e,t){var n=Math.min(e,t),r=Math.max(e,t);return n<=this&&this<=r},lerp:function(e,t){return e+(t-e)*this},log:function(e){return Math.log(this)/(void 0===e?1:Math.log(e))},log10:function(){return Math.log(this)/Math.LN10},maximum:function(e){return Math.max(this,e)},minimum:function(e){return Math.min(this,e)},modulo:function(e){return(this%e+e)%e},multiply:function(){var e=this;Array.prototype.slice.call(arguments).forEach(function(t){e*=t});return e},normalize:function(e,t){return e==t?1:(this-e)/(t-e)},raiseTo:function(e){return Math.pow(this,e)},radiansToDegrees:function(){return 180*this/Math.PI},rand:function(e){var t;return void 0!==e?(t=Math.min(this,e),e=Math.max(this,e),t+Math.floor(Math.random()*(e-t))):Math.floor(Math.random()*this)},random:function(e){var t;return void 0!==e?(t=Math.min(this,e),e=Math.max(this,e),t+Math.random()*(e-t)):Math.random()*this},remainder:function(e){return this%e},round:function(e){var t;e=e||0;t=this*Math.pow(10,e);t=Math.round(t);return t/=Math.pow(10,e)},roundDown:function(){return Math.floor(this)},roundUp:function(){return Math.ceil(this)},scale:function(e,t,n,r){e=this.normalize(e,t);return n==r?r:n+e*(r-n)},sine:function(){return Math.sin(this)},subtract:function(){var e=this;Array.prototype.slice.call(arguments).forEach(function(t){e-=t});return e},tangent:function(){return Math.tan(this)},toArray:function(){return[this.valueOf()]},toNumber:function(){return this.valueOf()},toPaddedString:function(e){return("0000000000000"+String(this)).slice(-e)},toSignedString:function(){var e=""+this;0<=this&&(e="+"+e);return e},toString:function(){return""+this}});e.extend(String.prototype,{capitalize:function(){return this.charAt(0).toUpperCase()+this.slice(1)},invert:function(){var e="",t;for(t=0;t<this.length;t++)e=this.charAt(t)===this.charAt(t).toUpperCase()?e+this.charAt(t).toLowerCase():e+this.charAt(t).toUpperCase();return e},justifyCenter:function(e){var t=Math.round(this.length/2),n=this.length-t,r=Math.round(e/2),t=r-t;e=e-r-n;n=this;if(0<t)for(;t--;)n=" "+n;else 0>t&&(n=n.substr(-1*t));if(0<e)for(;e--;)n+=" ";else 0>e&&(n=n.substr(0,n.length+e));return n},justifyLeft:function(e){for(var t=this;t.length<e;)t+=" ";return t},justifyRight:function(e){for(var t=this;t.length<e;)t=" "+t;return t},multiply:function(e){var t,n="";e=r.cascade(e,2);for(t=0;t<e;t++)n+=this;return n},reverse:function(){var e,t="";for(e=0;e<this.length;e++)t=this[e]+t;return t},size:function(){return this.length},toEntities:function(){var e,t="";for(e=0;e<this.length;e++)t+="&#"+this.charCodeAt(e)+";";return t},toCamelCase:function(){var e=this.split(/\W+|_+/),t=e[0],n;for(n=1;n<e.length;n++)t+=e[n].capitalize();return t},directionToDegrees:function(){var e="N NNE NE NEE E SEE SE SSE S SSW SW SWW W NWW NW NNW N".split(" "),t=e.indexOf(this.toUpperCase());return 0<=t?t.scale(0,e.length-1,0,360):Number.NaN},toArray:function(){return[this]},toNumber:function(){return parseFloat(this)},toString:function(){return this},toUnderscoreCase:function(){var e=this.replace(/[A-Z]+/g,function(e){return"_"+e});"_"===e.charAt(0)&&(e=e.substr(1));return e.toLowerCase()},toUnicode:function(){var e,t,n="";for(e=0;e<this.length;e++){for(t=this.charCodeAt(e).toString(16).toUpperCase();4>t.length;)t="0"+t;n+="\\u"+t}return n}});e.extend(Array.prototype,{distanceTo:function(e){var t,n=0;0<arguments.length&&(e=Array.prototype.slice.call(arguments));if(this.length===e.length){for(t=0;t<this.length;t++)n+=Math.pow(e[t]-this[t],2);return Math.pow(n,.5)}return null},first:function(){return this[0]},last:function(){return this[this.length-1]},maximum:function(){return Math.max.apply(null,this)},middle:function(){return this[Math.round((this.length-1)/2)]},minimum:function(){return Math.min.apply(null,this)},rand:function(){return this[Math.floor(Math.random()*this.length)]},random:function(){return this[Math.floor(Math.random()*this.length)]},shuffle:function(){var e=this.length,t,n,r;if(0==e)return!1;for(;--e;)t=Math.floor(Math.random()*(e+1)),n=this[e],r=this[t],this[e]=r,this[t]=n;return this},toArray:function(){return this},toHtml:function(){var e,t="<ul>";for(e=0;e<this.length;e++)t=this[e]instanceof Array?t+this[e].toHtml():t+("<li>"+this[e]+"</li>");return t+"</ul>"},toText:function(e){var t,n,i;e=r.cascade(e,0);n="\n"+"	".multiply(e);i="";for(t=0;t<this.length;t++)i=this[t]instanceof Array?i+(n+this[t].toText(e+1)):i+(n+this[t]);return i}});e.Color=function(e,t,n,r,i){this.name=e;this.initial=t;this.hex=n;this.styleF=r;this.styleB=i};var i,s,o,u,a,f,l;i=e.WHITE=new e.Color("white","W","#FFF","font-weight: bold; color: #888","background-color: #F3F3F3; color: rgba( 0, 0, 0, 0.5 )");s=e.ORANGE=new e.Color("orange","O","#F60","font-weight: bold; color: #F60","background-color: #F60; color: rgba( 255, 255, 255, 0.9 )");o=e.BLUE=new e.Color("blue","B","#00D","font-weight: bold; color: #00D","background-color: #00D; color: rgba( 255, 255, 255, 0.9 )");u=e.RED=new e.Color("red","R","#F00","font-weight: bold; color: #F00","background-color: #F00; color: rgba( 255, 255, 255, 0.9 )");a=e.GREEN=new e.Color("green","G","#0A0","font-weight: bold; color: #0A0","background-color: #0A0; color: rgba( 255, 255, 255, 0.9 )");f=e.YELLOW=new e.Color("yellow","Y","#FE0","font-weight: bold; color: #ED0","background-color: #FE0; color: rgba( 0, 0, 0, 0.5 )");e.COLORLESS=new e.Color("NA","X","#DDD","color: #EEE","color: #DDD");e.Direction=function(e,t,n){this.id=e;this.name=t.toLowerCase();this.normal=n;this.initial=t.substr(0,1).toUpperCase();this.neighbors=[];this.opposite=null};e.Direction.prototype.setRelationships=function(e,t,n,r,i){this.neighbors=[e,t,n,r];this.opposite=i};e.Direction.getNameById=function(e){return"front up right down left back".split(" ")[e]};e.Direction.getIdByName=function(e){return{front:0,up:1,right:2,down:3,left:4,back:5}[e]};e.Direction.getDirectionById=function(t){return[e.Direction.FRONT,e.Direction.UP,e.Direction.RIGHT,e.Direction.DOWN,e.Direction.LEFT,e.Direction.BACK][t]};e.Direction.getDirectionByInitial=function(t){return{F:e.Direction.FRONT,U:e.Direction.UP,R:e.Direction.RIGHT,D:e.Direction.DOWN,L:e.Direction.LEFT,B:e.Direction.BACK}[t.toUpperCase()]};e.Direction.getDirectionByName=function(t){return{front:e.Direction.FRONT,up:e.Direction.UP,right:e.Direction.RIGHT,down:e.Direction.DOWN,left:e.Direction.LEFT,back:e.Direction.BACK}[t.toLowerCase()]};e.Direction.getDirectionByNormal=function(){var t=new n.Vector3;return function(n){t.x=Math.round(n.x);t.y=Math.round(n.y);t.z=Math.round(n.z);return t.equals(e.Direction.FRONT.normal)?e.Direction.FRONT:t.equals(e.Direction.BACK.normal)?e.Direction.BACK:t.equals(e.Direction.UP.normal)?e.Direction.UP:t.equals(e.Direction.DOWN.normal)?e.Direction.DOWN:t.equals(e.Direction.LEFT.normal)?e.Direction.LEFT:t.equals(e.Direction.RIGHT.normal)?e.Direction.RIGHT:null}}();e.Direction.prototype.getRotation=function(e,t,n){void 0===t&&(t=this.neighbors[0]);if(t===this||t===this.opposite)return null;n=void 0===n?1:n.modulo(4);for(var r=0;5>r&&this.neighbors[r]!==t;r++);return this.neighbors[r.add(n*e).modulo(4)]};e.Direction.prototype.getClockwise=function(e,t){return this.getRotation(1,e,t)};e.Direction.prototype.getAnticlockwise=function(e,t){return this.getRotation(-1,e,t)};e.Direction.prototype.getDirection=function(e,t){return this.getRotation(1,t,e.id-1)};e.Direction.prototype.getUp=function(t){return this.getDirection(e.Direction.UP,t)};e.Direction.prototype.getRight=function(t){return this.getDirection(e.Direction.RIGHT,t)};e.Direction.prototype.getDown=function(t){return this.getDirection(e.Direction.DOWN,t)};e.Direction.prototype.getLeft=function(t){return this.getDirection(e.Direction.LEFT,t)};e.Direction.prototype.getOpposite=function(){return this.opposite};e.Direction.FRONT=new e.Direction(0,"front",new n.Vector3(0,0,1));e.Direction.UP=new e.Direction(1,"up",new n.Vector3(0,1,0));e.Direction.RIGHT=new e.Direction(2,"right",new n.Vector3(1,0,0));e.Direction.DOWN=new e.Direction(3,"down",new n.Vector3(0,-1,0));e.Direction.LEFT=new e.Direction(4,"left",new n.Vector3(-1,0,0));e.Direction.BACK=new e.Direction(5,"back",new n.Vector3(0,0,-1));e.Direction.FRONT.setRelationships(e.Direction.UP,e.Direction.RIGHT,e.Direction.DOWN,e.Direction.LEFT,e.Direction.BACK);e.Direction.UP.setRelationships(e.Direction.BACK,e.Direction.RIGHT,e.Direction.FRONT,e.Direction.LEFT,e.Direction.DOWN);e.Direction.RIGHT.setRelationships(e.Direction.UP,e.Direction.BACK,e.Direction.DOWN,e.Direction.FRONT,e.Direction.LEFT);e.Direction.DOWN.setRelationships(e.Direction.FRONT,e.Direction.RIGHT,e.Direction.BACK,e.Direction.LEFT,e.Direction.UP);e.Direction.LEFT.setRelationships(e.Direction.UP,e.Direction.FRONT,e.Direction.DOWN,e.Direction.BACK,e.Direction.RIGHT);e.Direction.BACK.setRelationships(e.Direction.UP,e.Direction.LEFT,e.Direction.DOWN,e.Direction.RIGHT,e.Direction.FRONT);e.Queue=function(e){void 0!==e&&e instanceof Function&&(this.validate=e);this.history=[];this.useHistory=!0;this.future=[];this.isReady=!0;this.isLooping=!1};e.Queue.prototype.add=function(){var e=Array.prototype.slice.call(arguments);void 0!==this.validate&&this.validate instanceof Function&&(e=this.validate(e));e instanceof Array&&e.forEach(function(e){this.future.push(e)}.bind(this));return this.future};e.Queue.prototype.remove=function(){var e=Array.prototype.slice.call(arguments);e instanceof Array&&e.forEach(function(e){this.future=this.future.filter(function(t){return t!=e})}.bind(this));return this.future};e.Queue.prototype.purge=function(){var e=Array.prototype.slice.call(arguments);e instanceof Array&&e.forEach(function(e){this.history=this.history.filter(function(t){return t!=e})}.bind(this));return this.history};e.Queue.prototype.empty=function(e){this.future=[];e&&(this.history=[])};e.Queue.prototype.do=function(){if(this.future.length){var e=this.future.shift();this.useHistory&&this.history.push(e);return e}this.isLooping&&(this.future=this.history.slice(),this.history=[])};e.Queue.prototype.undo=function(){if(this.history.length){var e=this.history.pop();this.future.unshift(e);return e}};e.Queue.prototype.redo=function(){return this.do()};e.Twist=function(e,t){e&&this.set(e,t)};e.Twist.prototype.set=function(t,n){var r={X:"Cube on X",L:"Left face",M:"Middle slice",R:"Right face",Y:"Cube on Y",U:"Up face",E:"Equator slice",D:"Down face",Z:"Cube on Z",F:"Front face",S:"Standing slice",B:"Back face"}[t.toUpperCase()];if(void 0!==r){void 0!=n&&0>n&&(t=t.invert(),n=n.absolute());var i=0,s="unwise";t===t.toUpperCase()?(i=1,s="clockwise"):t===t.toLowerCase()&&(i=-1,s="anticlockwise");this.command=t;this.group=r;this.degrees=n;this.vector=i;this.wise=s;this.isShuffle=!1;this.getInverse=function(){return new e.Twist(t.invert(),n)}}else return!1};e.Twist.prototype.equals=function(e){return this.command===e.command&&this.degrees===e.degrees};e.Twist.prototype.copy=function(e){this.command=e.command;this.group=e.group;this.degrees=e.degrees;this.vector=e.vector;this.wise=e.wise;this.isShuffle=e.isShuffle;return this};e.Twist.validate=function(){var t=Array.prototype.slice.call(arguments),n,i,s,o,u,a;for(i=0;i<t.length;i++)if(n=t[i],s=i+1<t.length?t[i+1]:void 0,!(n instanceof e.Twist))if("string"===typeof n)if(1===n.length)t[i]="number"===typeof s?new e.Twist(n,s):new e.Twist(n);else{if(1<n.length){s=/(-?\d+|[XLMRYUEDZFSB])/gi;n=n.match(s);for(u=0;u<n.length;u++)o=n[u],r.isNumeric(o)?n[u]=+o:(s=n.slice(0,u),a=n.slice(u+1),o=o.split(""),n=s.concat(o,a));s=t.slice(0,i);a=t.slice(i+1);t=s.concat(n,a);i--}}else n instanceof e.Direction?t[i]=n.initial:n instanceof Array?(s=t.slice(0,i),a=t.slice(i+1),t=s.concat(n,a)):t.splice(i,1),i--;return t};e.Cubelet=function(t,r,o){n.Object3D.call(this);this.cube=t;this.id=r||0;this.setAddress(this.id);this.size=t.cubeletSize||140;t=this.addressX*(this.size+.1);r=this.addressY*(this.size+.1);var u=this.addressZ*(this.size+.1);this.position.set(t,r,u);this.matrixSlice=(new n.Matrix4).makeTranslation(t,r,u);this.updateMatrix();this.cube.object3D.add(this);t=0;void 0===o&&(o=[i,s,,,a]);this.faces=[];for(r=0;6>r;r++)u=o[r]||e.COLORLESS,this.faces[r]={},this.faces[r].id=r,this.faces[r].color=u,this.faces[r].normal=e.Direction.getNameById(r),this.faces[r].isIntrovert=u===e.COLORLESS,u!==e.COLORLESS&&t++;this.type=["core","center","edge","corner"][t];this.front=this.faces[0];this.up=this.faces[1];this.right=this.faces[2];this.down=this.faces[3];this.left=this.faces[4];this.back=this.faces[5];this.colors=(this.faces[0].color?this.faces[0].color.initial:"-")+(this.faces[1].color?this.faces[1].color.initial:"-")+(this.faces[2].color?this.faces[2].color.initial:"-")+(this.faces[3].color?this.faces[3].color.initial:"-")+(this.faces[4].color?this.faces[4].color.initial:"-")+(this.faces[5].color?this.faces[5].color.initial:"-");this.isStickerCubelet=this.front.color&&"white"===this.front.color.name&&"center"===this.type;this.isTweening=!0;this.isTweening=this.isEngagedZ=this.isEngagedY=this.isEngagedX=!1;this.opacity=1;this.radius=0};e.Cubelet.prototype=Object.create(n.Object3D.prototype);e.extend(e.Cubelet.prototype,{setAddress:function(e){this.address=e||0;this.addressX=e.modulo(3).subtract(1);this.addressY=-1*e.modulo(9).divide(3).roundDown().subtract(1);this.addressZ=-1*e.divide(9).roundDown().subtract(1)},hasColor:function(e){var t,n,i=r.hexToRgb(e.hex);for(e=0;6>e;e++)if(n=r.hexToRgb(this.faces[e].color.hex),n.r===i.r&&n.g===i.g&&n.b===i.b){t=e;break}return void 0!==t?"front up right down left back".split(" ")[t]:!1},hasColors:function(){var e=this,t=!0;Array.prototype.slice.call(arguments).forEach(function(n){t=t&&!!e.hasColor(n)});return t},getRadius:function(){return this.radius},setRadius:function(e,n){if(!1===this.isTweening&&(e=e||0,void 0===this.radius&&(this.radius=0),this.radius!==e)){this.isTweening=!0;var r=(this.radius-e).absolute(),i={radius:this.radius};(new t.Tween(i)).to({radius:e},r).easing(t.Easing.Quartic.Out).onUpdate(function(){this.position.set(this.addressX.multiply(this.size+i.radius)+.2,this.addressY.multiply(this.size+i.radius)+.2,this.addressZ.multiply(this.size+i.radius)+.2);this.updateMatrix();this.matrixSlice.copy(this.matrix);this.radius=i.radius}.bind(this)).onComplete(function(){this.isTweening=!1;this.position.set(this.addressX.multiply(this.size+i.radius)+.2,this.addressY.multiply(this.size+i.radius)+.2,this.addressZ.multiply(this.size+i.radius)+.2);this.updateMatrix();this.matrixSlice.copy(this.matrix);this.radius=i.radius;n instanceof Function&&n()}.bind(this)).start(this.cube.time)}}});e.Group=function(){this.cubelets=[];this.add(Array.prototype.slice.call(arguments))};e.extend(e.Group.prototype,n.EventDispatcher.prototype);e.extend(e.Group.prototype,{add:function(){var t=this;Array.prototype.slice.call(arguments).forEach(function(n){n instanceof e.Group&&(n=n.cubelets);n instanceof Array?t.add.apply(t,n):t.cubelets.push(n)});return this},remove:function(t){t instanceof e.Group&&(t=t.cubelets);if(t instanceof Array){var n=this;t.forEach(function(e){n.remove(e)})}for(var r=this.cubelets.length;0<r--;)this.cubelets[r]===t&&this.cubelets.splice(r,1);return this},isFlagged:function(e){var t=0;this.cubelets.forEach(function(n){t+=n[e]?1:0});return t},isTweening:function(){return this.isFlagged("isTweening")},isEngagedX:function(){return this.isFlagged("isEngagedX")},isEngagedY:function(){return this.isFlagged("isEngagedY")},isEngagedZ:function(){return this.isFlagged("isEngagedZ")},isEngaged:function(){return this.isEngagedX()+this.isEngagedY()+this.isEngagedZ()},hasProperty:function(t,n){var r=new e.Group;this.cubelets.forEach(function(e){e[t]===n&&r.add(e)});return r},hasId:function(e){return this.hasProperty("id",e)},hasAddress:function(e){return this.hasProperty("address",e)},hasType:function(e){return this.hasProperty("type",e)},hasColor:function(t){var n=new e.Group;this.cubelets.forEach(function(e){e.hasColor(t)&&n.add(e)});return n},hasColors:function(){var t=new e.Group,n=Array.prototype.slice.call(arguments);this.cubelets.forEach(function(e){e.hasColors.apply(e,n)&&t.add(e)});return t},isSolved:function(t){if(t){var n={},r=0;t instanceof e.Direction&&(t=t.name);this.cubelets.forEach(function(e){e=e[t].color.name;void 0===n[e]?(n[e]=1,r++):n[e]++});return 1===r?!0:!1}console.warn("A face [String or ERNO.Controls] argument must be specified when using ERNO.Group.isSolved().");return!1},show:function(){this.cubelets.forEach(function(e){e.show()});return this},hide:function(){this.cubelets.forEach(function(e){e.hide()});return this},showPlastics:function(){this.cubelets.forEach(function(e){e.showPlastics()});return this},hidePlastics:function(){this.cubelets.forEach(function(e){e.hidePlastics()});return this},showExtroverts:function(){this.cubelets.forEach(function(e){e.showExtroverts()});return this},hideExtroverts:function(){this.cubelets.forEach(function(e){e.hideExtroverts()});return this},showIntroverts:function(e,t){this.cubelets.forEach(function(n){n.showIntroverts(e,t)});return this},hideIntroverts:function(e,t){this.cubelets.forEach(function(n){n.hideIntroverts(e,t)});return this},showStickers:function(){this.cubelets.forEach(function(e){e.showStickers()});return this},hideStickers:function(){this.cubelets.forEach(function(e){e.hideStickers()});return this},showWireframes:function(){this.cubelets.forEach(function(e){e.showWireframes()});return this},hideWireframes:function(){this.cubelets.forEach(function(e){e.hideWireframes()});return this},showIds:function(){this.cubelets.forEach(function(e){e.showIds()});return this},hideIds:function(){this.cubelets.forEach(function(e){e.hideIds()});return this},showTexts:function(){this.cubelets.forEach(function(e){e.showTexts()});return this},hideTexts:function(){this.cubelets.forEach(function(e){e.hideTexts()});return this},getOpacity:function(){var e=0;this.cubelets.forEach(function(t){e+=t.getOpacity()});return e/this.cubelets.length},setOpacity:function(e,t){this.cubelets.forEach(function(n){n.setOpacity(e,t)});return this},getRadius:function(){var e=0;this.cubelets.forEach(function(t){e+=t.getRadius()});return e/this.cubelets.length},setRadius:function(e,t){this.cubelets.forEach(function(n){n.setRadius(e,t)});return this}});e.Slice=function(t,r){this.axis=new n.Vector3;this.invertedAxis=new n.Vector3;this.matrix=new n.Matrix4;this.axis.rotation=0;this.indices=t;this.neighbour=null;this.ableToHideInternalFaces=!0;this.cube=r;this.getCubelet=function(e){return r.cubelets[t[e]]};this.rotateGroupMappingOnAxis=function(){var i=new n.Vector3,s=new n.Vector3(1,1,1),o=new n.Vector3,u=new n.Vector3,a=new n.Matrix4,f;return function(n){n=Math.round(n/(.25*Math.PI))*Math.PI*.25;i.copy(s);i.sub(this.axis);var l=r.cubelets.slice();a.makeRotationAxis(this.axis,-1*n);for(var c=t.length,p;0<c--;)p=r.cubelets[t[c]],o.set(p.addressX,p.addressY,p.addressZ),u.copy(o),o.multiply(i).applyMatrix4(a),o.x=Math.round(o.x),o.y=Math.round(o.y),o.z=Math.round(o.z),o.add(u.multiply(this.axis)),o.add(s),o.y=2-o.y,o.z=2-o.z,r.cubelets[p.address]=l[9*o.z+3*o.y+o.x];for(c=0;c<r.cubelets.length;c++)r.cubelets[c].setAddress(c);a.makeRotationAxis(this.axis,n);this.cubelets.forEach(function(t){f=[];t.faces.forEach(function(t,n){o.copy(e.Direction.getDirectionByName(t.normal).normal);o.applyMatrix4(a);f[e.Direction.getDirectionByNormal(o).id]=t;t.normal=e.Direction.getDirectionByNormal(o).name});t.faces=f.slice();t.front=t.faces[0];t.up=t.faces[1];t.right=t.faces[2];t.down=t.faces[3];t.left=t.faces[4];t.back=t.faces[5]})}}();this.map()};e.Slice.prototype=Object.create(e.Group.prototype);e.extend(e.Slice.prototype,{get origin(){return this.cube.cubelets[this.indices[4]]},get north(){return this.cube.cubelets[this.indices[1]]},get northEast(){return this.cube.cubelets[this.indices[2]]},get east(){return this.cube.cubelets[this.indices[5]]},get southEast(){return this.cube.cubelets[this.indices[8]]},get south(){return this.cube.cubelets[this.indices[7]]},get southWest(){return this.cube.cubelets[this.indices[6]]},get west(){return this.cube.cubelets[this.indices[3]]},get northWest(){return this.cube.cubelets[this.indices[0]]},get cubelets(){for(var e=[],t=this.indices.length;0<t--;)e.push(this.getCubelet(t));return e},map:function(t,r){for(var i=0;6>i;i++)if(this.origin.faces[i].color&&this.origin.faces[i].color!==e.COLORLESS){this.color=this.origin.faces[i].color;this.face=e.Direction.getNameById(i);break}if(void 0===this.axis||0===this.axis.lengthSq()){var i=this.northEast.position.clone(),s=this.southWest.position.clone(),o=this.northWest.position.clone();this.axis=(new n.Vector3).crossVectors(s.sub(i),o.sub(i)).normalize();this.axis.rotation=0}this.up=new e.Group(this.northWest,this.north,this.northEast);this.equator=new e.Group(this.west,this.origin,this.east);this.down=new e.Group(this.southWest,this.south,this.southEast);this.left=new e.Group(this.northWest,this.west,this.southWest);this.middle=new e.Group(this.north,this.origin,this.south);this.right=new e.Group(this.northEast,this.east,this.southEast);(i=this.hasType("center"))&&1===i.cubelets.length?(this.center=this.hasType("center"),this.corners=new e.Group(this.hasType("corner")),this.cross=new e.Group(this.center,this.hasType("edge")),this.ex=new e.Group(this.center,this.hasType("corner"))):this.centers=new e.Group(this.hasType("center"));this.edges=new e.Group(this.hasType("edge"));this.ring=new e.Group(this.northWest,this.north,this.northEast,this.west,this.east,this.southWest,this.south,this.southEast);this.dexter=new e.Group(this.northWest,this.origin,this.southEast);this.sinister=new e.Group(this.northEast,this.origin,this.southWest);return this},set rotation(e){if(this.ableToHideInternalFaces&&0!==this.cube.isFlagged("showingIntroverts")&&this.cube.hideInvisibleFaces){var t=0!==e%(.5*Math.PI);this.invertedAxis.copy(this.axis).negate();t?this.neighbour?(this.showIntroverts(this.axis,!0),this.neighbour.showIntroverts(this.invertedAxis,!0)):(this.cube.showIntroverts(this.axis,!0),this.cube.showIntroverts(this.invertedAxis,!0)):this.neighbour?(this.hideIntroverts(null,!0),this.neighbour.hideIntroverts(null,!0)):this.cube.hideIntroverts(null,!0)}this.matrix.makeRotationAxis(this.axis,e);this.axis.rotation=e;e=this.indices.length;for(var r=new n.Matrix4;e--;)t=this.getCubelet(e),t.matrix.multiplyMatrices(this.matrix,t.matrixSlice),t.position.setFromMatrixPosition(t.matrix),t.scale.setFromMatrixScale(t.matrix),r.extractRotation(t.matrix),t.quaternion.setFromRotationMatrix(r)},get rotation(){return this.axis.rotation},getLocation:function(e){return e===this.origin?"origin":e===this.north?"north":e===this.northEast?"northEast":e===this.east?"east":e===this.southEast?"southEast":e===this.south?"south":e===this.southWest?"southWest":e===this.west?"west":e===this.northWest?"northWest":!1},isSolved:function(t){if(t){var n={},r,i=this.indices.length,s=0;t instanceof e.Direction&&(t=t.name);for(;0<i--;)r=this.getCubelet(i),r=r[t].color.name,void 0===n[r]?(n[r]=1,s++):n[r]++;return 1===s?!0:!1}console.warn("A face [String or ERNO.Controls] argument must be specified when using ERNO.Group.isSolved().");return!1}});e.Fold=function(e,t){this.map=[e.northWest[e.face].text,e.north[e.face].text,e.northEast[e.face].text,t.northWest[t.face].text,t.north[t.face].text,t.northEast[t.face].text,e.west[e.face].text,e.origin[e.face].text,e.east[e.face].text,t.west[t.face].text,t.origin[t.face].text,t.east[t.face].text,e.southWest[e.face].text,e.south[e.face].text,e.southEast[e.face].text,t.southWest[t.face].text,t.south[t.face].text,t.southEast[t.face].text]};e.Fold.prototype.getText=function(){var e="";this.map.forEach(function(t){e+=t.innerHTML});return e};e.Fold.prototype.setText=function(e){var t;e=e.justifyLeft(18);for(t=0;18>t;t++)this.map[t].innerHTML=e.substr(t,1)};e.Projector=function(){return function(e,t){function r(e,t){d.getInverse(t.projectionMatrix);o.multiplyMatrices(t.matrixWorld,d);return e.applyProjection(o)}function i(n,i,o){var l=t,h=l!==document?l.getBoundingClientRect():{left:0,top:0,width:window.innerWidth,height:window.innerHeight};l!==document&&(l=l.ownerDocument.documentElement,h.left+=window.pageXOffset-l.clientLeft,h.top+=window.pageYOffset-l.clientTop);s=h;a.x=(i-s.left)/s.width*2-1;a.y=(o-s.top)/s.height*-2+1;a.z=-1;f.set(a.x,a.y,1);r(a,n);r(f,n);f.sub(a).normalize();c.set(a,f);u.getInverse(e.matrixWorld);c.applyMatrix4(u);return c}var s,o=new n.Matrix4,u=new n.Matrix4,a=new n.Vector3,f=new n.Vector3(1,1,1),l=new n.Vector3,c=new n.Ray,h=new n.Box3,p=new n.Sphere,d=new n.Matrix4,v=a.distanceTo(f);h.min.set(.5*-e.size,.5*-e.size,.5*-e.size);h.max.set(.5*e.size,.5*e.size,.5*e.size);p.radius=v*e.size*.5;return{getIntersection:function(t,r,s,o,u){o=o||new n.Vector3;if(null===r||null===s)return null;i(t,r,s);return c.isIntersectionSphere(p)&&null!==c.intersectBox(h,o)?(u&&(t=l||new n.Vector3,t.copy(o).set(Math.round(t.x),Math.round(t.y),Math.round(t.z)).multiplyScalar(2/e.size).set(t.x|0,t.y|0,t.z|0),u.setFromNormalAndCoplanarPoint(l,o)),o):null},getIntersectionOnPlane:function(e,t,n,r,s){if(null===t||null===n)return null;i(e,t,n);return c.intersectPlane(r,s)},getCubeletAtIntersection:function(){var t=new n.Vector3;return function(n){t.copy(n).add(h.max).multiplyScalar(3/e.size).set(Math.min(t.x|0,2),Math.min(3-t.y|0,2),Math.min(3-t.z|0,2));return e.cubelets[9*t.z+3*t.y+t.x]}}()}}}();e.Interaction=function(){return function(t,r,i,s,o){function u(e){C.enabled&&2!==e.button&&(v=(e.touches&&e.touches[0]||e).clientX,m=(e.touches&&e.touches[0]||e).clientY,l.getIntersection(r,v,m,c,b)&&(null!==e.touches&&e.preventDefault(),0===t.isTweening()&&(N="undefined"!==typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),C.active=!0,h=l.getCubeletAtIntersection(c),p=[t.slices[h.addressX+1],t.slices[h.addressY+4],t.slices[h.addressZ+7]],i.addEventListener("mousemove",a),i.addEventListener("touchmove",a),i.addEventListener("mouseup",f),i.addEventListener("touchcancel",f),i.addEventListener("touchend",f),i.removeEventListener("mousedown",u),i.removeEventListener("touchstart",u))))}function a(e){C.active&&(S.x=(e.touches&&e.touches[0]||e).clientX,S.y=(e.touches&&e.touches[0]||e).clientY);C.enabled&&(e.preventDefault(),e.stopImmediatePropagation())}function f(n){var r=(n.touches&&n.touches[0]||n).clientX,s=(n.touches&&n.touches[0]||n).clientY;C.active=!1;C.enabled&&(r!==m||s!==m)&&y&&(null!==n.touches&&n.preventDefault(),n=d.name[0].toUpperCase(),r=Math.round(T/Math.PI*2)*Math.PI*.5,.3<w.length()/(("undefined"!==typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now())-N)&&(r=Math.floor(T/Math.PI*2)*Math.PI*.5,r+=0<E.dot(w.normalize())?.5*Math.PI:0),t.twist(new e.Twist(n,r.radiansToDegrees())));N=0;S.x=void 0;S.y=void 0;y=!1;d=null;i.removeEventListener("mousemove",a);i.removeEventListener("touchmove",a);i.removeEventListener("mouseup",f);i.removeEventListener("touchend",f);i.removeEventListener("touchcancel",f);i.addEventListener("mousedown",u);i.addEventListener("touchstart",u)}var l=new e.Projector(t,i),c=new n.Vector3,h,p,d,v,m,g=new n.Vector3,y=!1,b=new n.Plane,w=new n.Vector3,E=new n.Vector3,S=new n.Vector2;new n.Vector3;var x=new n.Vector3,T=0,N=0;S.x=void 0;S.y=void 0;var C={active:!1,enabled:!0,multiDrag:o||!1,multiDragSnapArea:100,dragSpeed:s||1.3};n.EventDispatcher.prototype.apply(C);C.getIntersectionAt=function(){var e=new n.Vector3,t=new n.Plane;return function(n,i){return null===l.getIntersection(r,n,i,e,t)?null:{cubelet:l.getCubeletAtIntersection(e),face:1===t.normal.x?"RIGHT":-1===t.normal.x?"LEFT":1===t.normal.y?"UP":-1===t.normal.y?"DOWN":1===t.normal.z?"FRONT":"BACK"}}}();C.update=function(){var e=S.x,n=S.y;C.enabled&&C.active&&void 0!==e&&void 0!=n&&(v!==e||m!==n)&&(l.getIntersectionOnPlane(r,e,n,b,g),w.subVectors(g,c),!y&&5<w.length()&&(d&&(d.rotation=0),y=!0,x.crossVectors(b.normal,w),e=Math.max(Math.abs(x.x),Math.abs(x.y),Math.abs(x.z)),x.x=x.x/e|0,x.y=1===x.x?0:x.y/e|0,x.z=1===x.x||1===x.y?0:x.z/e|0,d=p[Math.abs(3*x.z+2*x.y+x.x)-1],E.crossVectors(d.axis,b.normal).normalize()),y&&(w.subVectors(g,c),T=E.dot(w)/t.size*C.dragSpeed),d&&(d.rotation=T))};i.addEventListener("mousedown",u);i.addEventListener("touchstart",u);var k=function(e,t){var n=this.getIntersectionAt(e,t);return n?(this.dispatchEvent(new CustomEvent("click",{detail:n})),!0):!1}.bind(C),L,A;i.addEventListener("mousedown",function(e){L=e.clientX;A=e.clientY});i.addEventListener("mouseup",function(e){var t=e.clientX;e=e.clientY;!y&&Math.abs(Math.sqrt((t-L)*(t-L)+(e-A)*(e-A)))<10*(window.devicePixelratio||1)&&k(L,A)});i.addEventListener("touchstart",function(e){L=e.touches[0].clientX;A=e.touches[0].clientY});i.addEventListener("touchend",function(e){var t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY;!y&&Math.abs(Math.sqrt((t-L)*(t-L)+(n-A)*(n-A)))<10*(window.devicePixelratio||1)&&k(L,A)&&e.preventDefault()});return C}}();e.Controls=function(){var t,r;t=0;r=1;return function(i,s,o){function u(e){y.enabled&&1===e.which&&null===g.getIntersection(s,e.pageX,e.pageY)&&(p=t,d.multiplyScalar(0),w(e.pageX,e.pageY,v),m.copy(v),y.domElement.removeEventListener("mousedown",u),document.addEventListener("mousemove",a),document.addEventListener("mouseup",f))}function a(e){y.enabled&&(e.preventDefault(),p=t,w(e.pageX,e.pageY,v),d.subVectors(v,m),m.copy(v))}function f(e){document.removeEventListener("mousemove",a);document.removeEventListener("mouseup",f);y.domElement.addEventListener("mousedown",u);y.enabled&&(p=r)}function l(e){y.enabled&&null===g.getIntersection(s,e.touches[0].pageX,e.touches[0].pageY)&&(p=t,d.multiplyScalar(0),w(e.touches[0].pageX,e.touches[0].pageY,v),m.copy(v),y.domElement.removeEventListener("touchstart",l),document.addEventListener("touchend",h),document.addEventListener("touchmove",c))}function c(e){y.enabled&&(p=t,w(e.changedTouches[0].pageX,e.changedTouches[0].pageY,v),d.subVectors(v,m),m.copy(v))}function h(e){document.removeEventListener("touchend",h);document.removeEventListener("touchmove",c);y.domElement.addEventListener("touchstart",l);y.enabled&&(p=r)}var p=-1,d=new n.Vector2,v=new n.Vector2;new n.Vector2;var m=new n.Vector2,g=new e.Projector(i,o),y={enabled:!0,domElement:o,rotationSpeed:4,damping:.25},w=function(e,t,n){var r;r=y.domElement;r=r!==document?r.getBoundingClientRect():{left:0,top:0,width:window.innerWidth,height:window.innerHeight};var i=window.devicePixelRatio||1;return n.set(.001*(e*i-r.width-r.left),.001*(r.height+r.top-t*i))};y.update=function(){var e=new n.Vector3,o=0,u=new n.Matrix4;return function(){!1!==y.enabled&&-1!==p&&(e.set(d.y,-1*d.x,0).normalize(),u.getInverse(i.matrixWorld),u.multiply(s.matrixWorld),e.transformDirection(u),d.multiplyScalar(1-Math.max(0,Math.min(1,y.damping))),o=d.length(),i.object3D.rotateOnAxis(e,-o*y.rotationSpeed),p===t?p=-1:p===r&&1e-4<=o?v.add(d):p=-1)}}();y.domElement.addEventListener("mousedown",u);y.domElement.addEventListener("touchstart",l);return y}}();var c=n.Scene;n.Scene=c||function(){};e.renderers=e.renderers||{};e.renderers.CSS3D=function(t,r){function i(e){e.style.display="block"}function s(e){e.style.display="none"}function o(){return Array.prototype.slice.call(a.domElement.querySelectorAll(".faceLabel"))}function u(){if(r.domElement.parentNode){var e=r.domElement.parentNode.clientWidth,t=r.domElement.parentNode.clientHeight;!r.domElement.parentNode||r.domElement.clientWidth===e&&r.domElement.clientHeight===t||r.setSize(e,t);a.render(f,r.camera)}requestAnimationFrame(u)}var a=new n.CSS3DRenderer,f=new n.Object3D;a.scene=f;f.add(r.autoRotateObj3D);f.add(r.camera);var l;new n.Vector3;r.faces.forEach(function(e,t){l=r[e.face].label=new n.CSS3DObject(document.createElement("div"));l.element.classList.add("faceLabel");l.position.copy(e.axis).multiplyScalar(r.size);l.position.negate();l.element.innerHTML=e.face.toUpperCase();r.object3D.add(l)});r.right.label.rotation.y=.5*Math.PI;r.left.label.rotation.y=-.5*Math.PI;r.back.label.rotation.y=Math.PI;r.up.label.rotation.x=-.5*Math.PI;r.down.label.rotation.x=.5*Math.PI;r.showFaceLabels=function(){o().forEach(i);this.showingFaceLabels=!0;return this};r.hideFaceLabels=function(){o().forEach(s);this.showingFaceLabels=!1;return this};e.extend(e.Cubelet.prototype,e.renderers.CSS3DCubelet.methods);t.forEach(e.renderers.CSS3DCubelet);requestAnimationFrame(u);c&&(n.Scene=c);return a};e.renderers.CSS3DCubelet=function(){return function(t){var r=document.createElement("div");r.classList.add("cubelet");r.classList.add("cubeletId-"+t.id);t.css3DObject=new n.CSS3DObject(r);t.css3DObject.name="css3DObject-"+t.id;t.add(t.css3DObject);var r=t.size/2,i=["rotateX(   0deg ) translateZ( "+r+"px ) rotateZ(   0deg )","rotateX(  90deg ) translateZ( "+r+"px ) rotateZ(   0deg )","rotateY(  90deg ) translateZ( "+r+"px ) rotateZ(   0deg )","rotateX( -90deg ) translateZ( "+r+"px ) rotateZ(  90deg )","rotateY( -90deg ) translateZ( "+r+"px ) rotateZ( -90deg )","rotateY( 180deg ) translateZ( "+r+"px ) rotateZ( -90deg )"],s="axisZ axisY axisX axisY axisX axisZ".split(" ");t.faces.forEach(function(n){n.element=document.createElement("div");n.element.classList.add("face");n.element.classList.add(s[n.id]);n.element.classList.add("face"+e.Direction.getNameById(n.id).capitalize());t.css3DObject.element.appendChild(n.element);var r=document.createElement("div");r.classList.add("wireframe");n.element.appendChild(r);r=document.createElement("div");r.classList.add("id");n.element.appendChild(r);var o=document.createElement("span");o.classList.add("underline");o.innerText=t.id;r.appendChild(o);r=n.element.style;r.OTransform=r.MozTransform=r.WebkitTransform=r.transform=i[n.id];n.isIntrovert?(n.element.classList.add("faceIntroverted"),n.element.appendChild(document.createElement("div"))):(n.element.classList.add("faceExtroverted"),r=document.createElement("div"),r.classList.add("sticker"),r.classList.add(n.color.name),n.element.appendChild(r),t.isStickerCubelet&&r.classList.add("stickerLogo"),r=document.createElement("div"),r.classList.add("text"),r.innerText=n.id,n.text=r,n.element.appendChild(r))});t.show();t.showIntroverts();t.showPlastics();t.showStickers();t.hideIds();t.hideTexts();t.hideWireframes()}}();e.renderers.CSS3DCubelet.methods=function(){function e(e){e.style.display="block"}function r(e){e.style.display="none"}return{getFaceElements:function(e){return Array.prototype.slice.call(this.css3DObject.element.querySelectorAll(".face"+(e||"")))},show:function(){e(this.css3DObject.element);this.showing=!0},hide:function(){r(this.css3DObject.element);this.showing=!1},showExtroverts:function(){this.getFaceElements(".faceExtroverted").forEach(e);this.showingExtroverts=!0},hideExtroverts:function(){this.getFaceElements(".faceExtroverted").forEach(r);this.showingExtroverts=!1},showIntroverts:function(){var t=new n.Vector3,r=new n.Matrix4,i;return function(n,s){i="";n&&(r.getInverse(this.matrix),t.copy(n).transformDirection(r),i=1===Math.abs(Math.round(t.x))?".axisX":1===Math.round(Math.abs(t.y))?".axisY":".axisZ");this.getFaceElements(".faceIntroverted"+(void 0!==n?i:"")).forEach(e);s||(this.showingIntroverts=!0)}}(),hideIntroverts:function(){var e=new n.Vector3,t=new n.Matrix4,i;return function(n,s){i="";n&&(t.getInverse(this.matrix),e.copy(n).transformDirection(t),i=1===Math.abs(Math.round(e.x))?".axisX":1===Math.round(Math.abs(e.y))?".axisY":".axisZ");this.getFaceElements(".faceIntroverted"+(void 0!==n?i:"")).forEach(r);s||(this.showingIntroverts=!1)}}(),showPlastics:function(){this.getFaceElements().forEach(function(e){e.classList.remove("faceTransparent")});this.showingPlastics=!0},hidePlastics:function(){this.getFaceElements().forEach(function(e){e.classList.add("faceTransparent")});this.showingPlastics=!1},hideStickers:function(){this.getFaceElements(" .sticker").forEach(r);this.showingStickers=!1},showStickers:function(){this.getFaceElements(" .sticker").forEach(e);this.showingStickers=!0},showWireframes:function(){this.getFaceElements(" .wireframe").forEach(e);this.showingWireframes=!0},hideWireframes:function(){this.getFaceElements(" .wireframe").forEach(r);this.showingWireframes=!1},showIds:function(){this.getFaceElements(" .id").forEach(e);this.showingIds=!0},hideIds:function(){this.getFaceElements(" .id").forEach(r);this.showingIds=!1},showTexts:function(){this.getFaceElements(" .text").forEach(e);this.showingTexts=!0},hideTexts:function(){this.getFaceElements(" .text").forEach(r);this.showingTexts=!1},getOpacity:function(){return this.opacity},setOpacity:function(e,n){this.opacityTween&&this.opacityTween.stop();void 0===e&&(e=1);if(e!==this.opacity){var r=this,i=(e-this.opacity).absolute().scale(0,1,0,200);this.opacityTween=(new t.Tween({opacity:this.opacity})).to({opacity:e},i).easing(t.Easing.Quadratic.InOut).onUpdate(function(){r.css3DObject.element.style.opacity=this.opacity;r.opacity=this.opacity}).onComplete(function(){n instanceof Function&&n()}).start()}},getStickersOpacity:function(e){return parseFloat(this.getFaceElements(" .sticker")[0].style.opacity)},setStickersOpacity:function(e){void 0===e&&(e=.2);var t=e;this.getFaceElements(" .sticker").forEach(function(e){e.style.opacity=t.toString()})}}}();e.Cube=function(t){e.Group.call(this);t=t||{};this.paused=void 0===t.paused?!1:t.paused;this.autoRotate=void 0===t.autoRotate?!1:t.autoRotate;this.keyboardControlsEnabled=void 0===t.keyboardControlsEnabled?!0:t.keyboardControlsEnabled;this.mouseControlsEnabled=void 0===t.mouseControlsEnabled?!0:t.mouseControlsEnabled;var r=t.renderer||e.renderers.CSS3D;t.textureSize=void 0===t.textureSize?120:t.textureSize;this.isShuffling=!1;this.isReady=!0;this.undoing=this.isSolving=!1;this.render=!0;this.finalShuffle=null;this.hideInvisibleFaces=void 0===t.hideInvisibleFaces?!1:t.hideInvisibleFaces;this.moveCounter=this.time=0;this.taskQueue=new e.Queue;this.twistQueue=new e.Queue(e.Twist.validate);this.historyQueue=new e.Queue(e.Twist.validate);this.twistDuration=void 0!==t.twistDuration?t.twistDuration:500;this.shuffleMethod=this.PRESERVE_LOGO;this.size=3*t.textureSize;this.cubeletSize=this.size/3;this.camera=new n.PerspectiveCamera(35,window.innerWidth/window.innerHeight,1,6e3);this.camera.position.z=4*this.size;this.object3D=new n.Object3D;this.autoRotateObj3D=new n.Object3D;this.rotation=this.object3D.rotation;this.quaternion=this.object3D.quaternion;this.position=this.object3D.position;this.matrix=this.object3D.matrix;this.matrixWorld=this.object3D.matrixWorld;this.rotation.set(25*Math.PI/180,-30*Math.PI/180,0);this.rotationDelta=new n.Euler(.1*Math.PI/180,.15*Math.PI/180,0);this.cubelets=[];[[i,s,,,a],[i,s,,,,],[i,s,o,,,],[i,,,,a],[i,,,,,],[i,,o,,,],[i,,,u,a],[i,,,u,,],[i,,o,u,,],[,s,,,a],[,s,,,,],[,s,o,,,],[,,,,a],[,,,,,],[,,o,,,],[,,,u,a],[,,,u,,],[,,o,u,,],[,s,,,a,f],[,s,,,,f],[,s,o,,,f],[,,,,a,f],[,,,,,f],[,,o,,,f],[,,,u,a,f],[,,,u,,f],[,,o,u,,f]].forEach(function(t,n){this.cubelets.push(new e.Cubelet(this,n,t))}.bind(this));this.core=new e.Group;this.centers=new e.Group;this.edges=new e.Group;this.corners=new e.Group;this.crosses=new e.Group;this.cubelets.forEach(function(e,t){"core"===e.type&&this.core.add(e);"center"===e.type&&this.centers.add(e);"edge"===e.type&&this.edges.add(e);"corner"===e.type&&this.corners.add(e);"center"!==e.type&&"edge"!==e.type||this.crosses.add(e)}.bind(this));this.left=new e.Slice([24,21,18,15,12,9,6,3,0],this);this.left.name="left";this.middle=new e.Slice([25,22,19,16,13,10,7,4,1],this);this.middle.name="middle";this.right=new e.Slice([2,11,20,5,14,23,8,17,26],this);this.right.name="right";this.right.neighbour=this.middle;this.left.neighbour=this.middle;this.up=new e.Slice([18,19,20,9,10,11,0,1,2],this);this.up.name="up";this.equator=new e.Slice([21,22,23,12,13,14,3,4,5],this);this.equator.name="equator";this.down=new e.Slice([8,17,26,7,16,25,6,15,24],this);this.down.name="down";this.down.neighbour=this.equator;this.up.neighbour=this.equator;this.front=new e.Slice([0,1,2,3,4,5,6,7,8],this);this.front.name="front";this.standing=new e.Slice([9,10,11,12,13,14,15,16,17],this);this.standing.name="standing";this.back=new e.Slice([26,23,20,25,22,19,24,21,18],this);this.back.name="back";this.back.neighbour=this.standing;this.front.neighbour=this.standing;this.faces=[this.front,this.up,this.right,this.down,this.left,this.back];this.slices=[this.left,this.middle,this.right,this.down,this.equator,this.up,this.back,this.standing,this.front];var l=function(e){this.dispatchEvent(new CustomEvent("onTwistComplete",{detail:{slice:e.target}}))}.bind(this);this.slices.forEach(function(e){e.addEventListener("change",l)});var c=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26];this.slicesDictionary={f:this.front,s:this.standing,b:this.back,u:this.up,e:this.equator,d:this.down,r:this.right,m:this.middle,l:this.left,x:new e.Slice(c,this),y:new e.Slice(c,this),z:new e.Slice(c,this)};this.slicesDictionary.x.ableToHideInternalFaces=!1;this.slicesDictionary.y.ableToHideInternalFaces=!1;this.slicesDictionary.z.ableToHideInternalFaces=!1;this.slicesDictionary.x.axis.set(-1,0,0);this.slicesDictionary.y.axis.set(0,-1,0);this.slicesDictionary.z.axis.set(0,0,-1);this.cubelets.forEach(function(e,t){e.setAddress(t)});this.renderer=r(this.cubelets,this);this.domElement=this.renderer.domElement;this.domElement.classList.add("cube");this.domElement.style.fontSize=this.cubeletSize+"px";this.autoRotateObj3D.add(this.object3D);this.hideInvisibleFaces&&this.hideIntroverts(null,!0);this.mouseInteraction=new e.Interaction(this,this.camera,this.domElement);this.mouseInteraction.addEventListener("click",function(e){this.dispatchEvent(new CustomEvent("click",{detail:e.detail}))}.bind(this));this.controls=new(t.controls||e.Controls)(this,this.camera,this.domElement);this.folds=[new e.Fold(this.front,this.right),new e.Fold(this.left,this.up),new e.Fold(this.down,this.back)];this.setSize(400,200);this.loop=this.loop.bind(this);requestAnimationFrame(this.loop);document.addEventListener("keypress",function(e){"input"!==e.target.tagName.toLowerCase()&&"textarea"!==e.target.tagName.toLowerCase()&&!this.mouseInteraction.active&&this.keyboardControlsEnabled&&(e=String.fromCharCode(e.which),0<="XxRrMmLlYyUuEeDdZzFfSsBb".indexOf(e)&&this.twist(e))}.bind(this))};e.Cube.prototype=Object.create(e.Group.prototype);e.Cube.prototype.constructor=e.Cube;e.extend(e.Cube.prototype,{shuffle:function(t,n){t=t||30;n=n||"";var r=this.shuffleMethod.slice(),i,s=new e.Twist,o,u=n.length,a=0;this.twistQueue.empty(!0);for(this.historyQueue.empty(!0);0<t--;){if(n)i.set(n[a]),a=(a+1)%u;else for(o=r.split(""),i=(new e.Twist).copy(s);i.equals(s);)i.set(o.splice(Math.floor(Math.random()*o.length),1)[0]);i.isShuffle=!0;this.twist(i);s=i.getInverse()}this.finalShuffle=i},solve:function(){this.isSolving=!0},isSolved:function(){return this.front.isSolved(e.Direction.FRONT)&&this.up.isSolved(e.Direction.UP)&&this.right.isSolved(e.Direction.RIGHT)&&this.down.isSolved(e.Direction.DOWN)&&this.left.isSolved(e.Direction.LEFT)&&this.back.isSolved(e.Direction.BACK)},undo:function(){0<this.twistQueue.history.length&&(this.historyQueue.add(this.twistQueue.undo().getInverse()),this.undoing=!0)},redo:function(){0<this.twistQueue.future.length&&(this.undoing=!0,this.historyQueue.empty(),this.historyQueue.add(this.twistQueue.redo()))},twist:function(e){this.undoing&&this.twistQueue.empty();this.historyQueue.empty();this.undoing=!1;this.twistQueue.add(e)},immediateTwist:function(e){.8<=this.verbosity&&console.log("Executing a twist command to rotate the "+e.group+" "+e.wise+" by",e.degrees,"degrees.");for(var n=this.slicesDictionary[e.command.toLowerCase()],r=(void 0===e.degrees?90:e.degrees)*e.vector,i=r.degreesToRadians(),s=Math.abs(i-n.rotation)/(.5*Math.PI)*this.twistDuration,o=n.indices.length,u;0<o--;)n.getCubelet(o).isTweening=!0;(new t.Tween(n)).to({rotation:i},s).easing(t.Easing.Quartic.Out).onComplete(function(){n.rotation=i;n.axis.rotation=0;for(o=n.indices.length;0<o--;)u=n.getCubelet(o),u.isTweening=!1,u.updateMatrix(),u.matrixSlice.copy(u.matrix);0!==r&&(n.rotateGroupMappingOnAxis(i),this.dispatchEvent(new CustomEvent("onTwistComplete",{detail:{slice:n,twist:e}})));e===this.finalShuffle&&(this.finalShuffle=null,this.dispatchEvent(new CustomEvent("onShuffleComplete",{detail:{slice:n,twist:e}})))}.bind(this)).start(this.time)},getText:function(e){if(void 0===e)return[this.folds[0].getText(),this.folds[1].getText(),this.folds[2].getText()];if(r.isNumeric(e)&&0<=e&&2>=e)return this.folds[e].getText()},setText:function(e,t){void 0===t?(this.folds[0].setText(e),this.folds[1].setText(e),this.folds[2].setText(e)):r.isNumeric(t)&&0<=t&&2>=t&&this.folds[t].setText(e)},setSize:function(e,t){this.camera.aspect=e/t;this.camera.updateProjectionMatrix();this.renderer.setSize(e,t)},PRESERVE_LOGO:"RrLlUuDdSsBb",ALL_SLICES:"RrMmLlUuEeDdFfSsBb",EVERYTHING:"XxRrMmLlYyUuEeDdZzFfSsBb",loop:function(){var e=0;return function(){requestAnimationFrame(this.loop);var n="undefined"!==typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),r=n-(e||n);e=n;this.paused||(this.time+=r,t.update(this.time),this.autoRotate&&(this.rotation.x+=this.rotationDelta.x,this.rotation.y+=this.rotationDelta.y,this.rotation.z+=this.rotationDelta.z),this.isReady&&0===this.isTweening()&&(n=this.undoing?this.historyQueue:this.twistQueue,0===n.future.length?this.isSolving&&window.solver?this.isSolving=window.solver.consider(this):!0===this.taskQueue.isReady&&(n=this.taskQueue.do(),n instanceof Function&&n()):(r=n.do(),"x"!==r.command.toLowerCase()&&"y"!==r.command.toLowerCase()&&"z"!==r.command.toLowerCase()&&0!==r.degrees&&(this.moveCounter+=this.undoing?-1:1),(0===r.degrees||r.isShuffle)&&n.purge(r),this.immediateTwist(r))),this.mouseInteraction.enabled=this.mouseControlsEnabled&&!this.finalShuffle,this.mouseInteraction.update(),this.controls.enabled=this.mouseControlsEnabled&&!this.mouseInteraction.active,this.controls.update())}}()});e.Solver=function(){this.logic=function(e){return!1}};e.Solver.prototype.consider=function(t){if(void 0===t)return console.warn("A cube [Cube] argument must be specified for Solver.consider()."),!1;if(!1===t instanceof e.Cube)return console.warn("The cube argument provided is not a valid Cube."),!1;t.isShuffling=!1;return t.isSolved()?(e.Solver.prototype.explain("Ive found that the cube is already solved."),!1):this.logic(t)};e.Solver.prototype.hint=function(e){console.log("%c"+e+"%c\n","background-color: #EEE; color: #333","")};e.Solver.prototype.explain=function(e){console.log("Solver says: %c "+e+" %c\n","color: #080","")};window.ERNO=e;window._=r;window.TWEEN=window.TWEEN||t;window.THREE=window.THREE||n})();var scram,algo,algor;(function(e){e.fn.gce=function(t,n){window.settings=e.extend({shufflespeed:10,speed:100,scramble:"",algorithm:"",highlight:"",text:""},t);this.filter("g-cube").each(function(){e(this).append('<div id="cubecont"></div>');window.cube=new ERNO.Cube;cube.rotation.y=-.8;cube.twistDuration=settings.speed;cube.keyboardControlsEnabled=false;cube.core.setOpacity(0);if(settings.scramble!=""){scram=ntscramble(settings.scramble.replace(/\/random/i,"").replace(/\/2-genR/i,"").replace(/\/2-genL/i,"").replace(/\/2-genM/i,"").replace(/\/3-genRF/i,"").replace(/\/3-genLF/i,"").replace(/\/3-genRL/i,""));cube.twistDuration=settings.shufflespeed;if(settings.scramble.match("/random")){if(settings.scramble.match("/2-genR")){cube.shuffleMethod="RrUu"}else if(settings.scramble.match("/2-genM")){cube.shuffleMethod="MmUu"}else if(settings.scramble.match("/2-genL")){cube.shuffleMethod="RrUu"}else if(settings.scramble.match("/3-genRF")){cube.shuffleMethod="RrUuFf"}else if(settings.scramble.match("/3-genLF")){cube.shuffleMethod="LlUuFf"}else if(settings.scramble.match("/3-genRL")){cube.shuffleMethod="RrUuLl"}else{cube.shuffleMethod="RrLlUuDdFfBb"}cube.shuffle(25)}else{cube.twist(scram)}cube.addEventListener("onShuffleComplete",function(){cube.twistDuration=settings.speed})}if(settings.algorithm!=""){algo=ntscramble(settings.algorithm);algor=ntsolve(settings.algorithm);cube.mouseControlsEnabled=false;e(this).prepend('<button class="playalg" style="top: 0; z-index: 100">Play Algorithm</button><br>Speed:<input class="speedslider" type="range" min="10" max="1500" value="'+settings.speed+'">');e(this).children(".playalg").click(function(){if(e(this).text()=="Play Algorithm"){cube.twistDuration=e(".speedslider").val();e(this).text("Reverse Algorithm");cube.twist(algo)}else{cube.twistDuration=10;cube.twist(algor);e(this).text("Play Algorithm")}})}if(!settings.highlight.match("all")){cube.hideStickers();if(settings.highlight.match("onlyedges")){cube.edges.showStickers();cube.centers.hideStickers();cube.corners.hideStickers()}else if(settings.highlight.match("onlycorners")){cube.corners.showStickers();cube.edges.hideStickers();cube.centers.hideStickers()}else if(settings.highlight.match("onlycenters")){cube.centers.showStickers();cube.edges.hideStickers();cube.corners.hideStickers()}else if(settings.highlight.match("flcross")){cube.down.cross.showStickers();cube.centers.showStickers();cube.rotation.x=100}else if(settings.highlight.match("flxcross")){cube.down.cross.showStickers();cube.centers.showStickers();cube.hasId(5).showStickers();cube.hasId(8).showStickers();cube.rotation.x=100}else if(settings.highlight.match("fl")&&!settings.highlight.match("flxcross")&&!settings.highlight.match("flcross")&&!settings.highlight.match("flcorners")){cube.down.showStickers();cube.rotation.x=100}else if(settings.highlight.match("flcorners")){cube.down.corners.showStickers();cube.rotation.x=100}else if(settings.highlight.match("f2l")&&!settings.highlight.match("f2ll")){cube.showStickers();cube.up.hideStickers();cube.rotation.x=100}else if(settings.highlight.match("f2ll")){cube.showStickers();cube.up.hideStickers();cube.hasId(5).hideStickers();cube.hasId(8).hideStickers();cube.rotation.x=100}else if(settings.highlight.match("llcross")){cube.showStickers();cube.up.hideStickers();cube.up.cross.showStickers()}else if(settings.highlight.match("llbar")){cube.showStickers();cube.up.hideStickers();cube.hasId(1).showStickers();cube.hasId(19).showStickers()}else if(settings.highlight.match("llL")){cube.showStickers();cube.up.hideStickers();cube.hasId(11).showStickers();cube.hasId(1).showStickers()}else if(settings.highlight.match("lldot")){cube.showStickers();cube.up.hideStickers();cube.up.center.showStickers()}else if(settings.highlight.match("llcorners")){cube.showStickers();cube.up.hideStickers();cube.up.corners.showStickers()}else if(settings.highlight.match("2x2x2")){cube.showStickers();cube.up.hideStickers();cube.back.hideStickers();cube.left.hideStickers();cube.rotation.x=100}else if(settings.highlight.match("2x2x3")){cube.showStickers();cube.up.hideStickers();cube.back.hideStickers();cube.rotation.x=100}else if(settings.highlight.match("eoline")){cube.showStickers();cube.up.hideStickers();cube.left.hideStickers();cube.right.hideStickers();cube.rotation.x=100}else if(settings.highlight.match("roux1")){cube.right.showStickers();cube.up.hideStickers();cube.rotation.x=100}else if(settings.highlight.match("roux2")){cube.right.showStickers();cube.left.showStickers();cube.up.hideStickers();cube.rotation.x=100}else if(settings.highlight.match("cmll")){cube.right.showStickers();cube.left.showStickers();cube.up.hideStickers();cube.up.corners.showStickers()}else{cube.showStickers()}}if(settings.text!=""){cube.showTexts();cube.setText(settings.text);cube.rotation.x=50.2}if(typeof n=="function"){n.call()}e("#cubecont").append(cube.domElement);console.log("gCube loaded.");console.log("Scramble: "+scram);console.log("Algorithm: "+algo);console.log("Highlight: "+algor)});return this}})(jQuery);$(document).ready(function(){$("head").prepend('<link rel="stylesheet" type="text/css" href="http://molarmanful.github.io/MoyuWeilong/cubenologo.css">',function(){console.log("G-cube stylesheet loaded.")})})
